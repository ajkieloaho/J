\section{Preface}
\label{preface1}
I will here describe the history of \textbf{J} in this preface in unusual
length and detail. Readers interested ony in the use of the current
software can perhasp look briefly the subsection Freedom. The reason
why I'm going through in detail
the difficulties with Luke is that I think that the leaders of Luke did not
treat me as researchers should be treated. I think also that the leaders of Luke
were willing to waste large amount of taxpayers' money when the prevented the
development and timely publication of \textbf{J} software. I hope that this part of the
preface gets some attention also outside the potential users of the software e.g.
in the ministry. As an amateur actor, I also hope that some play writer would
notice this and would make tragicomedy on the stage.
\subsection{JLP and first version of \textbf{J}}
\label{preface2}

I started to develop \textbf{J} software as a successor of the linear programming software
\textbf{J}LP \cite{JLP} around
2004. I had also done several programs for statistical computing (AKTA and Jakta)
since late seventies
when there was not
easy to use software even for ordinary linear regression.
Later I had to write own software
for mixed linear models. AKTA, Jakta, and JLP contained  means to use script files and
make new variables described in arithmetic expressions. The starting idea in \textbf{J} was to put all my
previous software developments into one program.
Version 0.9.3 of \textbf{J} was published in August 2004.

In JLP the crucial property was the utilization of the generalized upper bound (GUB) technique which
I invented and, which I could later find also in the literature (\cite{dant}), as I expected. GUB is
just the right technique which is
needed in foreast management planning. JLP made it possible to solve
significantly larger LP problems significantly faster
than using standard commercial LP software. In JLP I programmed all the necessary matrix
operations needed to change columns of the basis matrix in the revised simplex method.
I updated the inverse of the basis matrix explicitly,
instead of using factorization procedures as is the standard way in LP.
I treated nonbinding constraints in a nonstandard way
by reducing the dimension of the basis matrix instead of using residual
basic variables, as is normally done.

When I started to develop J, I thought that it might be good idea to use matrix routines
based on factorizations and developed by a professional in this field.
I found the LP software bqbd by Fletcher
based on \cite{flet}. The bqbd software was meant to use 'as is' software for linear and quadratic programming.
When I told Fletcher that I plan to separate the matrix routines needed in the GUB algorithm,
he told he is certain that I will not succeed, as his Fortran code did not have any comments.
He wrote that he will not have any time to help me.
However, it was not that difficult becasue his code was divided
to proper subroutines. His code did computations in
single precision, and it was necessary to change computations
into double precision. Because I do not have
a proper training in the rounding error business,
I had hoped his advice in changing the several tolerance
parameters to correspont double precision computations. In the development of the original JLP algorith,
I spent two-three times more time to fight rounding errors than to
get the code mathematically correct. Now I understood the rounding errors better, but
anyhow they are the permanent nuisance. The fundamental question
with respect to rounding errors is: is a small-looking number zero or non-zero.

When I later told him how large problems and how fast my algorithm could solve,
his attitude towards
my efforts clearly changed.

Even Bergseng from NMBU started to use \textbf{J} in forest management problems
in a quite premature
stage, and we had quite tough time to keep his project in time.
It took some time to clear a bug in Fletcher
code which every now and then took the optimization into a wrong path.
I had a quite slow computer, and the
data transwer between Norway and Finland was slow. The bug was such that
it had never caused problems in
standard applications of bqbd software. In forest planning problems
it can happen that after many
pivot operations only residual variables corresponding nonbinding
constrains are in the basis.
And when \textbf{J} refactorized of the basis after fixed number of pivot operations,
as is the common procedure, the basis became slightly corrupted.
In such a case, the refactorization is not needed. NMBU started to use \textbf{J}
together with their GAYA simulator, and called the whole system GAYA-J,
as the previous system was called GAYA-JLP.
I appreciate that they have acknowledged our co-operation this way.
\textbf{J} version 0.9.3 was published in
August 2004.

\textbf{J} contained also a simulator language by which one describe a simulator
which can be used to geneate
treatment schedules which are later optimized with the
LP funtions of J. When Simosol started
to develop sofware which would compete with the Mela, which had had a
monopoly status in planning software
in Finland, and had all the problems which are inevitable in all monopoly projects.
Simosol made first simulator developments using J, but moved to other solutions before first
published version of Simo software. Simosol however used the
linear programming routines
of J. Jussi Rasinmaki presented the software of Simosol
in the seminar 21.9.2018 celebrating the work of Pekka Kilkki.
When he did not mention J, which continues the work of Pekka Kilkki,
and I did not
find anything about \textbf{J} in the web pages of Simosol,
I asked whether they have stopped to use J.
Rasinmäki told that they are still using J, and he promised to mention the
co-operation in their web pages. I think that in co-operation
between research and
business, it would be necessary that the impact of research
would be openly recocnized by the business partners so
that the funders of research know that the research has been useful.
Now Simsol is part of Afry.
\subsection{\textbf{J} with factories: J2.0}
\label{preface3}
For me the most disturbing feature of \textbf{J} and JLP was that they were not able to treat factories.
I thought that the clever heuristic DTRAN algorithm of Howard Hoganson
(\cite{dtran} and \cite{howard} showed
that it should be possible to extend basic ideas of the
\textbf{J}LP algorithm to treat with factory
problems. I was able to derive the needed equations (see \cite{lappilem}).
Reetta Lempinen started to work with me to implement the formulas. Reetta has professional
training in programming, while I'm a self-learning amateur. The necessary
data structures were quite complicated.
I had made some wrong decisions which made the data structes even
more complicated than was necessary.
Reetta had a clear head to keep data structures in order.
It was a nice new experience to
work together through video connection on the code which both could
see simultaneously.
I just gave commands, but it was not necessary to give detailed
instructions because Reetta
understood from a half word what to do. An important
contribution of her was that when there were several dead ends,
and I started to doubt whether we can really
do what we were aiming at, she told, 'listen Juuso, we can solve this problem as we have
solved all previous problems'. Interestingly, the problems were usually not in any programming errors,
but the path could be found by raising to a little upper level and going to the main ideas.
Reetta's role was essential in the factory optimization. Also later she has been helpful in
minor technical matters, in writing the manual, testing the new developments etc. Recently she
adviced me how to use Git and Github. Reetta has also been
solidary during the painful Luke years, when she was not
allowed to work with \textbf{J} as she had liked
to do. I appreciate her contibution very much. She is the second author of this
manual and the paper \cite{lappilem} for good reasons. However, I use word 'I'
for such situtions where Reetta has not been involved in the decisions how to proceed. The factory optimization was implemeted in
\textbf{J} version 2.0. published in 2013.
\subsection{Battle over open-source J3.0 in Luke starts}
\label{preface4}

Initially I made the software so that only I could understand the structure and the code.
When Reetta started to work with me in factory problems,
I learned what are the weakest points in the software if it should be maintained
by a group of people. But as I was always able to tell Reetta how the software worked,
only very slight improvements in the documentation and comments of the code etc. were made.
When I realized that my retirement age is approaching,
I started to worry how the software could be maintained and developed after my retirement.

I had worked for Finnish Forest Research Institute (Metla) with small Academy
and University of Joensuu brakes since 1978. In 2015 Metla and
two other institutes were merged into Institute of Natural Resources Finland (Luke).
Based on my long service in a government organization, I expected that
the new organization would mean
new leaders, new lawyers, new bureaucrats, and  much more bureaucracy,
and less time
for researchers to do research, as always happens when
government organizations simplify
their administration and make it more efficient.
My expectations were in the right direction, but even in my worst
nightmares I could not have imagined
what Luke would mean to me personally.

Lauri Mehtätalo and I had agreed with an international publisher to
make a book about forest biometry. In Metla this kind of agreement had been
considered as a merit to Metla. But Luke forbad me to put any working time
to this book project. After retirement I was free to prepare this book with Lauri.
On the back-cover of the book I presented myself as a researcher of Metla
in order to give the affilation credit to Metla.
The co-operation
among statisticians of Luke, led by Juha Heikkinen, the continued co-operation
with Jaana Luoranen, and the support of the whole personell
of the Research Station of Suonenjoki when the leaders of Luke
started to humillate me
were my only positive experiences at Luke.

I started to clean and reorganize the \textbf{J} code so that it would be easier to maintain it.
My superior Olli Salminen forbad me to continue that effort because
he was certain that I would
never get that work ready. I didn't obey, of course not. The eternity of
this first cleaning round lasted two and
half weeks. Reorganization of files took 2-3 days, but programming
of a precompiler took
two weeks. In JLP I already had learned that a precompiler could help to manage
data areas of JLP. In J, the precompiler has greatly helped to manage
global variables.
The precompiler allows the users access global module variables
without knowing where they are. To separate the global variables
from local variables, the global variables have
j\_ or jlp\_ prefix. By changing the data structures,
\textbf{J} also became significantly faster
(main reason was that allocatable pointers were changed into allocatable arrays).


In 2014 when we were looking at how \textbf{J} could be utilized in Mela software, I encountered
old JLP concept ‘own function’, which was the method for allowing users of JLP to
add own (arithmetic) functions if they had access to the source code. I thought that this
idea would be useful also with respect to J. So, I organized \textbf{J} so that
different users could add their own \textbf{J} functions,
object types and options.

I was then convinced that the best way to utilize these improvements would be to
make the soft-ware open source. This would also allow me to continue my work freely
with \textbf{J} after my retirement.


The leaders of Luke agreed with me that the open-source \textbf{J} is a good idea.
Unfortunately they
also thought that open \textbf{J} is so important for Luke that the leaders could not
allow me to take care of the publication and prepare and present
the necessary decisions for their approval, or even participate as
member in the group which
started to hustle with the publication.
The leaders wanted themselves take care of the publication. Unfortunately, none
of the leaders involved
considered that the publication of \textbf{J} would be even so
important that he/she
had taken care that \textbf{J} would be eventually published.
They just wanted keep important
in the process. This absurd deadlock lasted almost seven years.

The previous version utilized some subroutines of IMSL package and from
the ‘Numerical Recipes in Fortran’ book. I replaced these subroutines mainly by
open access routines from Lapack and Ranlib packages from the Netlib library.
Roger Fletcher allowed to distribute his linear programming sub-routines in
the open \textbf{J} package. Fletcher gave a very liberal permission to use
his subroutines in open source distribution (the
price of his bqbd sofware was perhaps 100-200 Euros).
But the lawyers of Luke studied his permission
so long that he died before giving permission with better formulation.
A permission with
better formualations was obtained from his department in Dundee University.
But the leading
laywer of Luke, Emilia Katajajuuri was not satisfied, she wanted make
sure that the
legal position of the person
who gave the new permission was such that he could give the permission.



The following persons were involved in
process: Päivi Eskelinen, Olli Salminen, Kari T. Korhonen, Kimmo Kukkavuori,
Tuula Packalen, Sirpa Thessler, Sari Forsman-Hugg, Emilia Katajajuuri and Johanna
Buchert. Iikka Sainio was an outside legal consult.

The leading lawyer of Emilia Katajuuri made my position clear
in a video meeting to which I also was accidentally invited to
listen their new instructions.
When I accidentally said 'could we decide that..', she interrupted me and said:
'Listen Juha,
you do not decide anything in this matter'. Their message was that
I have done my part, and now
I should keep out and not disturb their play with their new conquest.

When it was evident that the leaders of Luke wanted to get rid of me,
I threatened that I will not retire before the opening decision is done.
Sari Forsman-Hugg told she will make the decision. But as my threat
seemed to make no influence,
I retried at the beginning of 2017. When I despite of all
the humiliation and frustration still hoped that
some kind a co-operation with Luke would be possible,
I applied the position outside researcher,
which had provided me access to Luke's e-mail and library services. Sari Forsman-Hugg was not
able to make a decision also with recpect to my application.
I did withdraw my application
when my e-mail connections were interrupted two times.

Later I heard from Reetta that Luke had made the opening decision but
she did not know what kind decsion and
I was not informed of the decision either, in disargeeent with the distribution list
of the decision, as I noticed in when I finally could see the decision after
three years.
\subsection{Retired and still waiting for open \textbf{J}}
\label{preface5}
After my retirement I was still hoping that some kind of co-operation
without outside researcher status with Luke would be possible, and I
participated in the application of factory optimization which was published in \ref{pekka}.
Prof. Packalen told late 2017 that the publication of \textbf{J} is approaching.
When I asked about the opening decision, she 'did not
remember' what it contained but promised to check it out, which she
did forget to do or atl least forget to tell me what the decision contained.
Prof. Packalen was planning a very high level launch of
\textbf{J} with prominent international guests. I wrote that such
seminar would not probably be worth of
for trans-Atlantic flights. I was so stupid that
I believed her promise that the publication of \textbf{J} was approaching
and I submitted a correction to a bug which produced some amount of negative timber
quantities.

During 2018-2021 I made some small parameter adjustments for Simosol and Norway and made some additions
for my own research. Prof. Packalen had lost all interest in the publication,
and she did not allow Reetta to
develop the publication documents. When I heard 2020 that prof Packalen
had left Luke and could
not prevent publication any more, I asked Reetta to
ask her superiors whether she could continue
the preparation of manuals. She got the permission to use some time for that.
This work with all style details was not very nice for her as she
had already done big part of the work for the previous format of
Lukes's report series.
The report series had changed the formats, and Reetta had to do
such tedious work she already had done once before.
Reetta's superiors did never  discuss with me anything related to the
manuals or to the code. This
way they had been free to pretent that I have not contributed to
the work if \textbf{J} had been some time published.


In spring 2021 Hannu Salminen from Luke contacted me. He had memory
problems with a very large data set. I made a rapid fix for his acute
problem and did develop
more permanent solutions for large data sets using direct access files.
Actually that work was
unncessary as Viktor Strimbu from  NMBU  adviced me later how to make
\textbf{J} a 64-bit
application using MSYS2 environment. The Gfortran environment I had
used before did not
support 64-bit applications. The 64-bit program allows to put the whole country
into one run aslo in factory optimization. Hannu organized a video
meeting where we discussed the
development and utilization of the \textbf{J} software. He was the first person
in Lukes six years history who
was willing to discuss with me such things.

I started to work with \textbf{J} again. Reetta had told that \textbf{J} had could
collapse after some hours of computations in  large data sets in factory optimization.
I asked Luke to get the problematic
data sets so that I could try to fix the problem. I got the answer that Luke is not allowed to send the
data sets, and the answer did  not indicate
that Luke would do anything to get such permission.
I was quite upset from such answer,
and I started to think how to open the deadlock situation. Later I got the data,
and I was able to fix the problem, which was not exactly
a clear bug but rather a thin-ice place in the algorithm sot that \textbf{J} did drop
throug the ice when going over the place repeatedly.
\subsection{Operation Charles XII}
\label{preface6}
When I strarted to think how I could find a way out from the deadlock,
I remembered Charles XII,
the king of Sweden (wich included  also Finland). He was in war with Denmark
and he decided to fight Denmark by attacking Norway, which belonged to Denmark.
He failed as almost his solders died in snowstorms
in Northern Norway and he was shot by his own soldier.
I was in conflict with Luke, even if Luke did
acknowledge that such confilict existed
because Luke insisted that in a legal sense,
I did not even exist in this \textbf{J} affair.
I thought to conquer Norway with nice \textbf{J} codes.
Renovation of my co-operation with GAYA group
suited their plans as they were rebuilding their simulator.

I wrote to Johanna Buchert, director general of Luke (who was already in the group of
Luke leaders hustling in the publication of \textbf{J} when I was in Luke)
Antti Asikainen, research director of Luke,  and Kari T. Korhonen, who has
been involved in this \textbf{J} affair and was the superior of Reetta, and
told that I will not send to Luke new \textbf{J} codes including working
factory optimization codes without a written co-operation agreement.
I wrote also to registry-office and asked for the opening decision, and
to a lawyer of Luke and asked what kind of legal actions
Luke will take agaisnt me if I started to publish factory optimization
things with GAYA group using codes which I would not give to Luke.
The leaders did not comment in any way my co-operation proposal. The research director
just wrote that
all codes done in METLA are property of Luke. Buchert did not respond, but
the the Senior Vice President Ilkka P. Laurila answered that Luke regrets
for the delays in the publication of \textbf{J} caused by personell changes
(a funny expression for the fact that the publication process
could just start in 2020
when prof Packalen left Luke)
and
that Luke has started to prepare the publication and will publish the \textbf{J} on its
web pages. Kari T Korhonen did not respond.

Thus the leaders of Luke insisted that Luke will publish tens of thousands code
and manual lines I had written, and insisted that it has no reason
or obligation to discuss with
me what and in what form it will these lines publish.
It is evident that Luke had not been able to publish
\textbf{J} in my life time (I'm over 70 yrs and I have a heart disease).
But if I had been alive when Luke had
published \textbf{J} under my name, I had made a lawsuit againt Luke
for shaming my researcher honor
by publishing something I had not accepted for publication. Or perhaps
Luke had followed
the previous  custom of  Romania where all chemistry
research was published under the the name of Elena Ceaușescu,
and had published the the software and
manuals under the name of some equivalent to Elena.
Also in that case I had made a lawsuit
against Luke (if I had been alive). When the director general of Luke,
the research director of Luke, the Senior Vice President of Luke
and the lawyers of Luke
decided that Luke has absolutely no interest in
working factory optimization \textbf{J} codes or
other up to date \textbf{J} codes, did they discuss with any researchers?

After getting such a reponse to my co-opertation suggestion, it was evident that
I would not give Luke any new codes, and would require Luke to remove all codes I had
submitted after my retirement as Luke would not akckowledge that
it had got any codes from me after my retirement, and it would publish my codes
as if they were developed in Luke. So I would continue my Charles XII operation.
Unfortunately NMBU did not have factory and transportation cost data ready.  In Norway
the transportation costs can not be estimated as easily from coordinates as in Finland.

Laurila did send the decision to publish \textbf{J} as a open source software
after the lawyers of Luke
had considered two weeks whether Luke should do that. The decision was
signed by the research director Johanna Buchert 30.8. 2017.
The process of trying to
get permission to use Fletchers codes after his death was not described properly.
It was written
that after Fletchers death the university of Dundee did not
respond to queries of Luke. As decribed above, the things did not go that way.
When Luke was not satisfied with the corrected  permission sent
by the university, the university had probably decided that
it is vain to continue correspondece with Luke. However,
the university wanted to communicate with me,
when they asked my statement about the importance of Flethers
code in planning of natural resources.
The government wanted to figure out whether the
university is doing something useful. I think that my statement
was more valuable for
the university than the euros the university would loose when
not getting payments for the bqbd code.

The decision told that \textbf{J} is published under licence AGPLv3.
The licence is specially
planned for programs which provide computing services through the net.
Luke has not done anything to develop such net work services, as it has not
developed \textbf{J} in any way after my retirement in 2017.
The leaders of Luke did not discuss with
me the license matters, of cource not.

The decision nominated prof Packalen to take care of the launch of the software.
Unfortunately she could not organize the lauch, as \textbf{J} was not ready to publication
because prof Packalen did not allow Reetta to do the necessary
preparations with respect to the code and manuals.

The lawyers of Luke did not tell anything of the plans of Luke to make lawsuits
against me if I would co-operate with Norway and would not send new codes to Luke.

Lauri Mehtätalo became Professor in Mathematical Modeling for Forest Planning
in Luke in Mai 2021.
Coming from an university environment, he is interested
in the development of science
and research. He wanted to get \textbf{J} finally published after 6 year deadlock.
Lauri did have anything againts that I would take care
of the publication. Lauri even thought that it
would be good for science and research that I would
work without payment. It was a refreshing new attitude in Luke
to put science into priority.
Lauri told that he would try to convince the leaders of Luke
that it would not harm Luke's interests that I would
take care of the publication of
the software I had made (for most part). Lauri told initially that
he wants to persuade
me to give all new codes to Luke. When I protested his choice of words,
he apologized, and used thereafter the word 'negotiate'. When Lauri started to 'negotiate' with
me, I consider that Luke first time in its history acknowledged that I do exist
as an legal entity is this \textbf{J} affair.

Lauri was able to rotate the head of the research director 180 degrees. The research director even told
that he would be interested to become a coauthor in the publication dealing the factory
optimization. It was, however, not mentally feasible for me, as
he did not even
answer my previous co-operation suggestion, but just told that Luke has everything
it needs. Being a researcher, Lauri understood what
were my aims and was able to get approval of the research director.
So it seemed that
the agreement was about ready. But then the agreement was
stuck on the table of the research director.
\subsection{Last battle, victory and peace in Olavinlinna}
\label{preface7}
I was invited to the 100 year anniversary celebration of the Finnish National Forest Inventory
as I had worked also in the NFI group. I was interested to see my former colleagues,
but it started to disturb me
that I would not know whether I would be a guest of my enemy
or my co-operations partner.
I had a very exciting video meeting with the GAYA people. They promised me access
to the Norwegian supercomputers needed in large factory optimizations, funding for traveling
and for any consulting work. I started to think that have been stupid
when I spent years of my short residual life waiting for such co-operation
with Luke. As Lauri had tried
to establish such co-operation between me and Luke,
I decided to give Luke a last chance.
I made an ultimatum that if we do not get a agreement with Luke within a week,
I would break all negotiations with Luke and would continue only with Norwegian people,
even if Luke might try to make a lawsuit against me.
Twenty-four hours before the time
limit Lauri called that Luke is willing to make treaty with me.
The lawyers of Luke did finalize the treaty
two hours before the NFI celebration.

Antti Asikainen, the research director of Luke and I signed the co-opertation treaty in the king's hall in
Olavinlinna (St. Olaf's Castle) in Savonlinna 7.10. 2021.
In the treaty I got almost everything I had
fighted for: The \textbf{J} software will be published, and I have
full responsibility of the code and manuals.
Luke will provide me data of factory locations, simulated treatment schedules for
all inventory plots for the whole country, and the matrix of distances between the
factories and inventory plots. Luke will also provide me access to CSC
supercomputers which are necessary for the whole country optimizations. CSC does not allow
independent retirees to use its computers. I'm allowed to make a methodological
paper from developments, whereafter I will provide Luke all the
new and improved \textbf{J} functions and the developed \textbf{J} scripts. I had hoped that
Luke had promised me access to Mela so I could study how Mela is doing interest
rate computations, as I have suspects that these computations are not in order.
I had asked Olli Salminen some Mela results to study my suspects, but he told, after some
day considerations, that Luke is not willing to make such computations.
I suspect that the reason is
Luke wants to keep all possible Mela problems secret. I did not insist to get
such permissions as Lauri thought that this would delay and complicat
the \textbf{J} process. In the treaty it
is said that the code files state that Juha Lappi
and Natural Resources Institute Finland have the copyright for the code.
In the last minutes
before the signatures
the lawyers tried to reverse the order of copyright owners. I did not, of course,
accept the reveresed order, bacause I have made the \textbf{J} really operable after my retirement,
Now, the recent developments have made Lukes or Metlas contribution
even smaller, and the overall influence of Luke has been negative.
It must, however to be taken into account that Pekka M\"akinen has done valuable
work in collecting data of factories and
transportation costs, and this data greatly helps my work when I'm now allowed
to start to develop factory optimization for the whole Finland.
\subsection{Total balance with Luke}
\label{preface8}
At the signing of the peace treaty, Johanna Buchert told that there has not been any
disagreement in this \textbf{J} busisness, and let bygones be bygones.
From my point of view, I had six and half years fight to get permission to
publish the results of my research.  For Luke, there was no
disagreement because Luke did not acknowledge that I even existed as a
legal entity. How could Luke
have disagreement with something which does not even exist? For me,
the behavior of the leaders of Luke was a 'me too' experience. In
the heart of my researcher
identity is the conviction that every researcher, at least in a government
research institute, has the right and even the obligation to publish the
results of his research let it be a stastistical method or computer code or
ordinary research publication.
The leaders of Luke denied
me the right to publish the results of my statistical work
in our biometry book and the results of my software development.  In this \textbf{J} case,
the reason was that they
wanted to publish my results themselves.  This has been a very traumatic
harrasment experience. All the victims of sexual harassment are also
told that 'let bygones be bygones'.
As in the peace treaty I was given all responsibility of manuals, I'm
now utilizing this responsibility in this preface hoping the leaders of
Luke and perhaps also others
would be more careful when making decisions which may not tolerate daylight,
similarly
as bosses are slowly learning to keep better control of
their hands which would like
to grope the bottoms of their subordinates.

From the legal perspective, the leaders of Luke have insisted that
Luke has full copyright to all work I've done in Mela or Luke. So they can freely
follow their whims and waste hundreds of thousands of euros
taxpayers money used in the \textbf{J} project.
With Lukes overhead multipliers we may speak about millions.
Perhaps they should also pay
attention to the by-law telling what is the duty of Luke. How has
Luke promoted forest research and its utilization by prevented
the development and
utilization of \textbf{J} software for over six years?
Perhaps the ministry should  give
the leaders of Luke training about the duties of Luke. The leaders
of Luke never gave any rational justification why Luke should prevent me
to take care of the publication.

If I had been allowed to publish and develop \textbf{J} as I wanted,
Luke and forest industry would have
now available methods to analyze e.g. what can be done
when timber import from Russia suddenly stops.
Luke is also still doing static regional sustainability analyzes,
which are not reasonable
as they do not take factories into account. Mentally Luke
is stuck to the German foresters from
1800's who rotated a fixed cutting area for each year.
If Luke had let me publish the open-source software in 2015
Luke had been a forerunner in the open source publication, and I had praised it
for its progressive attitude. Now Luke has
has establised its status in the history of open-source as an institute which
decided to open a software
but keeps the decision and the code locked for several years because
it did not allow the principal
author to take care of or even participate in the publication.
\subsection{Freedom}
\label{preface9}
After the Olavinlinna peace treaty, I thought initially that
I would like to publish the software before Christmas 2021.
But when the iron cage around me disappeared, the pressure which had increased
in my mind for seven years did burst in intensive code development.
This development had already started when negotiations with Lauri started to look promising,
and I developed the program to make Latex files for manuals and script files
for examples automatically from comments embedded within the code or from a
separate text files.

After the peace treaty I have rewritten all the central parts of the
software using simpler and more easily maintained solutions,
and added many new properties. The most important was the rewriting
of the interpreter
which interprets the \textbf{J} code generated using the input programming capabilities.
I had been shamed if the previous interpreter had be offered to the eyes of
professional programmers. I did rewrite the precompiler so it takes only some
seconds to do the precompilation, and if the precompiled file
does not change the new precompiled file is deleted so that the compiler
does not do any more unnecessary compilation. I did put the matrix computations
into a new level implementing
all properties I had found useful in Matlab when providing a method for a client
using Matlab codes. I added new tools for debugging
and code development. Now \textbf{J} can treat nicely submatrices and do
all arithmetic operations and logical operations
on matrices in addition to scalars. The previous version of  \textbf{J} could make rough
figures using a separate program written in Intel
fortran, which I do no more have available. Publication level
figures could be done using R sripts generated by J.
Now \textbf{J} is producing figures using Gnuplot which is automatically run from within J.
Currently only basic 2D and 3D figures
can be done, but this Gnuplot connection makes it possible to develop \textbf{J}
into full scale interface to all Gnuplot properties. \textbf{J} can now generate random numbers from any
continuous or discrete distibution providing new possiblities to study the
effects of random errors in the simulation of treatment schedules or in
optimization. It is now  possible to run R scripts from within J.
Now \textbf{J} can be used easily also as a subroutine. Lauri has utilized this property
by calling \textbf{J} from R. This offers many new possiblities,
which we will utilize when
continuing the co-operation with the GAYA-group.

I made first cleaning of the important \textcolor{VioletRed}{jlp}() function in the spring of 2021
when correcting
the fragility which prevented the solution of large problems which take several hours in
a ordinary PC. There are many things to be done in \textcolor{VioletRed}{jlp}() function, but I start
to work with them when developing factory optimization in CSC supercomputers.
I know already how parallel computations can be utilized in \textcolor{VioletRed}{jlp}()-function.
Previous versions of \textbf{J} had special functions for developing forest simulators and
computing the simulated schedules. Now all simulators can be developed and utilized
using standard properties of \textbf{J} transformations either for using stand level
or tree level variables
I have not yet made good examples to demonstrate these properties. Because the new \textbf{J} provides
a platform for making all kind of new devlopments, including
integer optimization (i.e preventing treatment unit to be divided among several
schedules), nonlinear objective function
(which would utlize the capability of \textbf{J} to compute derivatives
according to analytic derivation rules), it was difficult to breathe a little and make the
new codes available for users. The codes now published contain many errors.
I invite the users to help me to correct them. First users should have some
patience with respect to errors. I claime that the bug percentage is smaller than
estimated 23-27\% bug percentage in the first version
of Windows 1, which accintally happened be the same as the bug percentage
Soviet masons used in the mortar they used when masoning the US embassy in Moscow.
Currently I can correct most bugs
causing system crash in 5-10 minutes. It should be emphasized that
Luke does not have any kind of responsibility of the errors.
I take the full moral responsibilty of the errors. Similarly, it should
be emphasized that Luke has no responsibility of the code which works correctly.
I take the main responsibility of the correctly working code,
giving Reetta her fair
share. It is easier for me to correct the errors while alive.
This fundamental fact of life
was ignored by Luke when it prevented the publication for seven years.

During the intensive work period after the Olavinlinna peace treaty, my deep
'me too' traumas have started to heal slowly. Probably this healing process takes
a long time, and I cannot very soon say let bygones be bygones.

\subsection{Changes from previous versions}
\label{changes}
The software is almost  completely rewritten. There are many new
functions and properties. All the previous users should  look at the
new properties.  If an old user has difficulties to run their old scripts they should
contact J.L. Note that graphics now assumes that Gnuplot is installed.

\section{Introduction}
\label{intro}
The \textbf{J} software can be used as is, i.e. using exe files. The User guide concentrates
on using binary files, but some reference is aslo made to additional possiblities offered
by the open \textbf{J} code which Luke finally after 7 years deadlock allowed to publish.
\subsection{Using exe files}
\label{intro1}
\textbf{J} is a general program for many different tasks. In one end, \textbf{J} is a programming language which
can be used to program several kind of applicatios and tasks, starting from computing 1+1, either
at \textcolor{Red}{sit>} promt or inside a trasformation object.
In the other end, it contains many functions which
can do several tasks in statistics, plotting figures,
deterministic and stochastic simulation and linear optimization. Forest planning with factories
using \textcolor{VioletRed}{jlp}() function can take several hours.
The general \textbf{J} functions and \textbf{J} trasformations can be combined in many ways.
!
The development of new \textbf{J} applications is made easier with special input programming. Input
programming can generate efficiently several \textbf{J} code lines with few lines so that any part of
object names can be have indices. \textbf{J} scripts can be read from include files which can contain
sections, so that all code of a project can be stored in one file. Different sections can
be executed by just writing the name of the section at \textcolor{Red}{sit>} prompt.
!
The code development is easy using efficient debugging tools. The output of a \textbf{J} function is printed
if the line ends with ';' or ';;'. After the code development, the printing can be put off without
changing the code by telling with \textcolor{teal}{Printresult} variable whether ';' or ';;' or - results
are printed. During \textcolor{VioletRed}{pause}() the user can do any computations and print objects and
then either continue or interrupt the process. With \textcolor{teal}{Debugconsole} variable the user can
tell whether \textcolor{VioletRed}{pause}() is generated after each command line read from an include file. With
\textcolor{teal}{Debugcode} the user can tell wther \textcolor{VioletRed}{pause}() is generated after each line when \textbf{J} excecutes
code made by the interpreter and which is packed into a transformation object.

\textbf{J} is now efficient program to do many kind matrix computations. After retirement I sold a client
an algorithm which I dad developed using J. I submitted the algorith using Matlab code,
and thus learned Matlab. Then I implemented all Matlab properties I found useful.
all arithemetical, trigonometric and logical funtions cand operate both on scalars and matrices.
Some useful extensios to normal computation rules were addewd. Matrices can be made
from submatrices, submatrices can be extracted from matrices and replaced by other
matrices.
!
The list object is used to transimit and acces object lists. If the list elements are
objects called REAL variables, the the list can be used in matrix computaions
in the same way as column vectors.
!
The input programming  has the following functions and capabilities.
\begin{itemize}
\item \textcolor{Red}{;incl}(file,\textcolor{blue}{form->}) include code from file starting from a label, e.g. as ;ad1;
\item \textcolor{Red}{;do}(i,ia1,ia2,step) generates input records in a loop
\item ;if();then \\ \textcolor{green}{!includes\,conditionally\,code}
\item objstart"i"end \,\textcolor{green}{!\,replaces\,i\,in\,the\,text\,with\,the\,integer\,value\,of\,i.\,Combined\,with\,\textcolor{Red}{;do}()}
this provides possiblitesd to generate large numer of lines using only some linse
\textcolor{Red}{;goto}() \,\textcolor{green}{!\,code\,is\,obtained\,from\,a\,different\,place\,of\,an\,include\,file.}
;elseif();then \\
;else \\
;endif
\end{itemize}

\textbf{J} functions can have arguments and options. Options are used to trasnmit optional arguments
to a function. Options are expressed as option->. If the option does not refer to a single object then
the value of the option must be put into parentrhesi.In some cases the prence or absence of an argument passes an logical
argument into a function. There tow groups of options, ordinaryy options and code options.
Ordinalry options treansmit either object names or numeric values into a function.
code options contain a short peice of code which is computed several times form within the function.
E.g. \textcolor{blue}{func->}\textcolor{VioletRed}{sin}(x) can tells the \textcolor{VioletRed}{draw}() function waht is the function to be drawn. If
computation of the codeoption rquires several lines, then thes lines can be
then the \textcolor{blue}{func->}tr(\textcolor{teal}{res}) is used to tell how the function value is computed.
\subsection{The components of the software package available in Github}
\label{pack}
!
\subsection{\textbf{J} functions}
\label{jfuncs0}
The general (non arithmetic) \textbf{J} functions are used either in statements

func(arg1,…,argn,opt1->value1,….,optm->valuem)

or

output=func(arg1,…,argn,opt1->value1,….,optm->valuem)\\
If there is no output for a function in a statement, then there can be three different cases:
i) The function does not produce any output (if an output would be given, then \textbf{J} would just
ignore it\\
ii) The function is producing output, and a default name is used for the output (e.g. Result
for arithmetic and matrix operations, Figure in graphic functions).\\
iii) The function is a sub expression within a transformation consisting of several parts including
other function or arithmetic operations. Then the output is put into a temporary unnamed
object which is used by upper level functions as an argument (e.g. a=\textcolor{VioletRed}{inverse}(b)*t(c))
If the value of an option is not a single object or numeric constant, then it must be enclosed in
parenthesis.\\
It is useful to think that options define additional argument sets for a function. Actually
an alternative for options would be to have long argument lists where the position of an
argument determines its interpretation. Hereafter generic term 'argument' may refer also to
the value of an option.

When \textbf{J} is interpreting a function, it is checking that the option names and the syntax
are valid, but it is not checking if an option is used by the function. Also when executing the
function, the function is reacting to all options it recognizes but it does not notice if there are
extra options, and these are thus just ignored.

An argument for a \textbf{J} function can be either functional statements producing a \textbf{J} object as its
value, or a name of \textbf{J} object. Some options can be without any argument (indicating that the
option is on).

An essential feature in \textbf{J} functions is that the driver subroutine which is computing
the functions is recursive. This recursion is used when code options SEE? are used to compute
the the output of an code option or when transformation objects are explcitly called
within an transformation object or a function dealing with data is computing \textcolor{blue}{trans->} transforamtion for each
observation.
\\
a = \textcolor{VioletRed}{sin}(\textcolor{VioletRed}{cos}(c)+b) &\textcolor{green}{!\,Usual\,arithmetic\,functions\,have\,numeric\,values\,as}
\\
arguments
\\
here the value of the argument of cos is obtained by 'computing' the
\\
value of real variable c.
\\
\\
\textcolor{VioletRed}{stat}(D,H,\textcolor{blue}{min->},\textcolor{blue}{max->}) &\textcolor{green}{!\,Here\,arguments\,must\,be\,variable\,names}
\\
\\
\textcolor{VioletRed}{plotyx}(H,D,\textcolor{blue}{xrange->}(\textcolor{VioletRed}{int}(D\%min,5), \textcolor{VioletRed}{ceiling}(D\%max,5))) &\textcolor{green}{!arguments\,of}
\\
the function are variables, arguments of option \textcolor{blue}{xrange->} are numeric
\\
values
\\
\\
c = \textcolor{VioletRed}{inverse}(h+\textcolor{VioletRed}{t}(g)) &\textcolor{green}{!\,The\,argument\,can\,be\,intermediate\,result\,from}
\\
matrix computations.
\\
If it is evident if a function or option should have object names or values as their arguments, it
\\
is not indicated with a special notation. If the difference is emphasized, then the values are
\\
indicated by val1,…valn, and objects by obj1,…,objn, or the names of real variables are
\\
indicated by var1,…,varn.
\\
There are some special options which do not refer to object names or values. Some options
\\
define a small one-statement transformation to be used to compute something repeatedly.
\\
\\
\textcolor{VioletRed}{stat}(D,H,\textcolor{blue}{filter->}(\textcolor{VioletRed}{sin}(D).gt.\textcolor{VioletRed}{cos}(H+1)) &!
\\
only those observations are
\\
accepted which pass the filter
\\
\\
\textcolor{VioletRed}{draw}(\textcolor{blue}{func->}(\textcolor{VioletRed}{sin}(\$x)+1),\textcolor{blue}{x->}\$x,\textcolor{blue}{xrange->}(0,10,1)) &\textcolor{green}{!\,the\,\textcolor{blue}{func->}\,option}
\\
transmits the function to be drawn not a single value.
\\
\subsection{Structure of general \textbf{J} functions}
\label{jfunc}
The general (non arithmetic) \textbf{J} functions are used either in statements

func(arg1,…,argn,opt1->value1,….,optm->valuem)

or

output=func(arg1,…,argn,opt1->value1,….,optm->valuem)

If there is no output for a function in a statement, then there can be three different cases:
\begin{itemize}
\item[\textbf{J}] The function does not produce any output (if an output would be given, then \textbf{J} would just
ignore it

\item[\textbf{J}] The function is producing output, and the default name {Result} is used for the output
for arithmetic and matrix operations.
\item[\textbf{J}] The function is a sub expression within a transformation consisting of several parts including
other function or arithmetic operations. Then the output is put into a temporary unnamed
object which is used by upper level functions as an argument (e.g. a=\textcolor{VioletRed}{inverse}(b)*t(c))
\end{itemize}
If the value of an option is not a single object or numeric constant, then it must be enclosed in
parenthesis.

\begin{note}
It is useful to think that options define additional argument sets for a function. Actually
an alternative for options would be to have long argument lists where the position of an
argument determines its interpretation. Hereafter generic term 'argument' may refer also to
the arguments of an option.
\end{note}
\begin{note}
When \textbf{J} is interpreting a function, it is checking that the option names and the syntax
are valid, but it is not checking if an option is used by the function. Also when executing the
function, the function is reacting to all options it recognizes but it does not notice if there are
extra options, and these are thus just ignored.
An argument for a \textbf{J} function can be either functional statements producing a \textbf{J} object as its
value, or a name of \textbf{J} object. Some options can be without any argument (indicating that the
option is on).
\end{note}
\begin{example}[jfuncex]Examples of J-functions\\
\label{jfuncex}
a = \textcolor{VioletRed}{sin}(\textcolor{VioletRed}{cos}(c)+b) \textcolor{green}{!\,Usual\,arithmetic\,functions\,have\,numeric\,values\,as\,arguments}\\
\textcolor{green}{!\,here\,the\,value\,of\,the\,argument\,of\,cos\,is\,obtained\,by\,'computing'\,the\,value\,of\,real\,variable\,c.}\\
Dm=\textcolor{VioletRed}{matrix}(\textcolor{blue}{do->}(0.1,40))\\
nob=\textcolor{VioletRed}{nrows}(Dm)\\
e=\textcolor{VioletRed}{matrix}(nob)\\
e=\textcolor{VioletRed}{rann}()\\
Hm=0.5+Dm**0.7+e\\
dat=\textcolor{VioletRed}{newdata}(Dm,Hm,\textcolor{blue}{read->}(D,H))\\
\textcolor{VioletRed}{stat}(D,H,\textcolor{blue}{min->},\textcolor{blue}{max->}) \textcolor{green}{!\,Here\,arguments\,must\,be\,variable\,names}\\
\textcolor{VioletRed}{plotyx}(H,D) \textcolor{green}{!arguments\,of\,the\,function\,are\,variables}\\
h=\textcolor{VioletRed}{matrix}(5,5);\\
h=\textcolor{VioletRed}{rann}();\\
g=\textcolor{VioletRed}{matrix}(5,\textcolor{blue}{do->}5);\\
c = \textcolor{VioletRed}{inverse}(h+\textcolor{VioletRed}{t}(g)); \textcolor{green}{!\,The\,argument\,can\,be\,intermediate\,result\,from\,matrix\,computations.}
\end{example}
\subsection{\textbf{J} objects}
\label{objintro}
\textbf{J} objects have a simple yet efficient structure. Each object is associate with a double precision
variable, two integer vectors, one single precision vector, one double precision vector,
one vector of characters and one vector of text lines. All vectors are allocated dynamically.
There are several object types which store data differently in these vectors.
Object can be either simple or compound objects. Compound objects are linked to other
objects which can be used also directly utilizing the standard naming conventions. All objects are
global, i.e. also users can acces all objects even if some predefined objects are locked so that
users cannot change them.

\subsection{System requirement}
\label{system}
The current binary versions of \textbf{J} are developed using Gfortran Fortran 90 compiler in MSYS2 MINGW 64-bit environment
under Windows 10. There are both release and debug versions available.
Binary versions are ordinary console applications. It is recommended that \textbf{J} is used in command
prompt window, so that
if execution of \textbf{J} terminates unexpectedly, the error debugging information, remains visible.
With the debug version the problematic line is indicated.
See chapter ? for more information of error handling.

See J3.0 Development Guide to start develop the software or to add
own functions. The development package contains, in addition to source code for
the standard \textbf{J} software, program Jmanual
which can be used to generate Latex code for the manual, program Jindent to make indentations for
Fortran source files and
a precompiler Jpre which writes necessary Fortran statements to access all globa \textbf{J} data structures.

Figures are made with Gnoplot.
Gnuplot is freely available at


https://sourceforge.net/projects/gnuplot/files/gnuplot/5.4.2/

Download  download gp542-win64-mingw.exe. This will install gnuplot on your windows
system under C:\Program Files\gnuplot\. \textbf{J} will strat Gnuplot automatically when
plotting figures.

\subsection{Set-up of \textbf{J}}
\label{setup}
The maximum number of available objects cannot be changed during a \textbf{J} session. It is determined during
the initialization. When \textbf{J} is started it tries to read first file j.par from the default directory
(see 'During the first use' chapter): The first line must look like
*2000
where the number gives the maximum number of named objects.  If j.par is not available, the default
number of objects is 5000.
Thereafter there can be in j.par file any number of \textbf{J} commands executed directly (e.g.
you can give shortcuts for
commands which are handy e.g. when including repeatedly certain sections from include files). If you
want to go directly into a specific J-application, you can put into j.par the corresponding include
command.
If \textbf{J} is started from command prompt, there can be an include file name in the command line. This
include file is run after commands read from j.par if it is available.  ?TESTAA
\subsection{During the first use}
\label{firstuse}
It is reasonable to have the exe versions and dll's found in
\textbf{J}bin folder in one folder, and to make shortcuts for exe-files
into all working folders. Edit the properties of the shortcut (right click the
shortcut icon) so that the starting directory is the working directory. Or
alternatively you can set the path to the folder containing \textbf{J} executable and
run \textbf{J} in your working directory. Copy also the file j.par into each working
directory.
It is recommended that \textbf{J} is run in the Command Prompt window even if it can be
run also directly from the program shortcut.
Edit first the properties of the I/O window if you are using \textbf{J} directly or from
the Command Prompt window. The properties of the I/O window can be changed by
right-clicking the-icon at the upper left corner. It is reasonable to make the
screen buffer rather large (large height) so that the whole history of the \textbf{J}
session can be seen (this is done in the layout sheet of the shortcut
properties). The default height of the I/O window is also probably too small.
The width should be at least 81. If you would like to use mouse in copy and
paste, put quick edit option on. Also the colours of the text and background of
the \textbf{J} window should be made healthier for eyes (dark text, bright background).
To see that \textbf{J} is running properly, give your first commands at \textcolor{Red}{sit>} prompt:
\textcolor{Red}{sit>}a=7.7;
!
The result should look
a=7.700000
\textcolor{Red}{sit>}
It is possible to use arrow keys to gwt previous command lines.
!
All input lines entered or generated by input programming at \textcolor{Red}{sit>} prompt are
called commands. Commands are either input programming commands (input
commands) or commands that define operations in the \textbf{J} working environment
(operation commands). Input commands and operation commands may read and
interpret more input lines before returning control to the command level.
It is most convenient to develop \textbf{J} applications using include files. There is
available in the jdoc-demo folder an include file jexamples.txt
which can be used to run all examples in this manual. If the include file
is in the working directory you can run any example by wrting the name of the example
in the J-window if you have given '\textcolor{Red}{;incl}(jexamples.txt)' at the \textcolor{Red}{sit>} pronpt.
The working environment of \textbf{J} consists of named objects, temporary objects,
constants, functions, arithmetic operations and text paragraphs. Operation
commands define simple arithmetic operations or more complicated operations on
the data structures. Operation commands are defined using a transformation
language. In addition to operation commands, the same transformation language
is used to define transformation objects which are computed as a group, usually severl times,
and which
can be linked in different ways to data structures or other
transformation objects.
\subsection{Exiting \textbf{J}}
\label{exit}
To exit \textbf{J} program and close console window, just give end command:

\textcolor{Red}{sit>}end
\subsection{Typographical conventions}
\label{typo}
In this manual function names are written in red, option names in blue, object types in
capital letters, object names within the text are written in this color: {Object}.
Names like {ob1} are used as generic names for object and names like  {var1}
are generic names for REAL variables.
If there is no output for an operation command line,
the object Result is used as the default output.
if the line ends with a single semicolon ';' or double semicolon ';;', then
the output may be printed depending MIHIN KOHTAAN
In many cases there is no output object, and a possible
output given is ignored. If an explicit output is necessary, then '=' is
put in front of the function name. Notation ‘[=]’ means that the output can be given but
it is not necessary. In most cases the default output Result is then used:
In some cases no output is then generated (this will be indicated).
For functions that return real values or matrices which can be
used directly in arithmetic or matrix operations,
the existence of output is not indicated.

\subsectione{Subroutines obtained from other sources}
\label{license}
The following subroutines are obtained from other sources.
\begin{itemize}

\item[\textbf{J}]  subroutine tautsp used in j\_function tautspline
from Carl de Boor (1978) A practical guide to splines. Springer, New York, p.310-314
No licence restrictions known
distribution:  http://pages.cs.wisc.edu/$\sim$deboor/pgs/tautsp.f

\item[\textbf{J}]  real function ppvalu used in \textbf{J} function value
from Carl de Boor (1978) A practical guide to splines. Springer, New York, p.310-314
No licence restrictions known
distribution: http://pages.cs.wisc.edu/$\sim$deboor/pgs/tautsp.f

\item[\textbf{J}] subroutine interv , used in function ppvalue
from Carl de Boor (1978) A practical guide to splines. Springer, New York, p.310-314
No licence restrictions known
obtained from: http://pages.cs.wisc.edu/$\sim$deboor/pgs/tautsp.f
Lapack matrix routines

\item[\textbf{J}] Several subroutines from www.netlib.org/lapack
licence : http://www.netlib.org/lapack/LICENSE.txt
\end{itemize}
\subsection{ joperation}
\label{joperation}
In this section the main tools in code devlopment in a project are presented. It is usefule to organize
the project sript into one script file, which conatians swections starting with a lable and ending
with \textcolor{Red}{;return}.
I think that it is more difficult to have several script files.
The example file jexamples.inc is a good eaxample of a script file.
\textcolor{green}{!The\,script\,files\,should\,start\,with\,shortcuts\,for\,each\,section.\,If\,it\,is\,possible\,that}
different versions of the same script file are stored in different names, it is useful to have
as first line something like
this=\textcolor{VioletRed}{thisfile}()//
Then it is not necessary to change anything if the file is stored in a different name.
Thereafter comes the shortcut defintiosn for different sections.
the same
For instance, if the the section
label is //
;thistask://
then the shortcut definition could be
thistaskh='\textcolor{Red}{;incl}(this,\textcolor{blue}{from->}thsitask)'//

The section should end with//
\textcolor{Red}{;return}//
After defining shortcuts for all sections, it is useful to have a shortcut as://
again=\textcolor{Red}{;incl}(this)//
If new sections are added, then one needs to give just shortcut//
again//
and then the new shortcuts will be defined. It does not matter if the earlier shortcuts are redefined.

The last shortcut could be //
current='\textcolor{Red}{;incl}(this,\textcolor{blue}{from->}current)
The label 'current' can be a floating label which is put into the section which is under developed
in place the problems started.

If a \textbf{J} code line, either in the input paragraph defining a transforamtion object
or outside it, ends with ';' or ';;', the the output object of the code line may be printed.
The output of ';'-line is printed if the variable \textcolor{teal}{Printoutput} has value 1 or 3 at the time when the the
code line is computed.
The output of ';;'-line is printed if the variable \textcolor{teal}{Printoutput} has value 2 or 3 at the time when the the
code line is computed.

If a code line within a tranformation has function \textcolor{VioletRed}{pause}('text'), then a pause is generated during which
the user can give any commands except
input programming commands. If the user will press <return> then the exceution continues. If the user
presses 'e' and <return>, the control comes to the \textcolor{Red}{sit>} promt similarly as during an error.

If the line outside the transforasmtion definition paragraph is '\textcolor{Red}{;pause}', then
a similar pause is generated except also input programming commands can be give.

If the variable \textcolor{teal}{Debugtrans} has value 1, them a \textcolor{VioletRed}{pause}() is genertated before each line within
a tranformation object is executed.  If variable \textcolor{teal}{Debugconsole} has value 1,
a '\textcolor{Red}{;pause}' is generated before  the line is excuted. In bot cases the user can
give new values for \textcolor{teal}{Debugtrans} and \textcolor{teal}{Debugconsole}.

What happens when an error is encountered is dependent on the value of variable \textcolor{teal}{Continue}. If \textcolor{teal}{Continue} has
value 0 8teh default case), the control comes into \textcolor{Red}{sit>} prompt when an real error occurs or if an atrficial
error condition is generated with \textcolor{VioletRed}{errexit}(). If \textcolor{teal}{Continue} has value 1 then the computation continues in
the same script file where the error occured. This property is used in file jexaples.inc to demosntrate
possible error conditions so that the computation continues as fi no error had occured.

\begin{example}[operexr]Exapmple of operation of J.\\
\label{operexr}

\end{example}

\section{Command input and output}
\label{cominout}
\textbf{J} has two programming levels. First level, called input programming, generates text lines which are then
transmitted to the interpreter which generates code which is the put into transformations sets or
excuted directly. Input programming loops make it possible to generate large number of command lines
in a compact and short form. This chapter describes input programming concepts and commands.
\subsection{Input record and input line}
\label{inpuline}
\textbf{J} reads input records from the current input channel which may be terminal, file or a text object.
When \textbf{J} interprets input lines, spaces between limiters and function or object names are not
significant. In input programming, functions start with ';' which is part of the function name (and
there can thus be no space immediately after ';'). If a line (record) ends with ',' ,'+', '*´, '-',
'(', '=' or with '>', then the next record is interpreted as a continuation record and
the continuation character is kept as a part of the input
line. If a line ends with '>>', then
the nex line is also continuation line, and  '>>' is ignored. All continuation
records together form one input line. In previous version input programming functions operated on input lines
but now they operate on recors. One input record can contain 4096 characters, and an input line can contain also 4096 characters
(this can be increased if needed).
The continuation line cannot start with ‘*’ or ‘\textcolor{green}{!’\,because\,these\,are\,reserved}
to indicate comments.  Note: '/' (division)cannot be used as last character indicating the continuation of the line because it can
be legal last character indicating the end of an input paragraph.

When entering input lines from the keyboard, the previous lines given from the keyboard can no more be
accessed and edited using the arrow keys owing to MSYS2 MSYS environment used to build the exe-file.
To copy text from the \textbf{J} window into the clipboard right-click the upper left icon, select Edit,
and then select Mark. Next click and drag the cursor to select the text you want to copy and
finally press Enter (or right-click the title bar, select Edit, and in the context menu click Copy).
To paste text from the clipboard into the \textbf{J} command line right-click the title bar, select Edit,
and in the context menu click Paste. Console applications of Intel Fortran do not provide copy
and paste using <cntrl>c and <cntrl>v. An annoying feature of the current command window is that it is possible
All input lines starting with '*' will be comments, and in each line text starting with '!' will also
be interpreted as comment (\textcolor{green}{!debug\,will\,put\,a\,debugging\,mode\,on\,for\,interpretation\,of\,the}
line, but this debug information can be understood only by the author). If a comment line starts
with '*\textcolor{green}{!',\,it\,will\,be\,printed.}
\subsection{Input Paragraph}
\label{inpupara}
Many \textbf{J} functions interpreted and executed at the command level need or can use a group of
text lines as input. In these cases the additional input lines are immediately after the function.
This group of lines is called input paragraph. The input paragraph ends with '/', except the
input paragraph of text function ends with '//' as a text object can contain ordinary input
paragraphs. It may be default for the function that there is input paragraph following. When
it is not a default, then the existence of the input paragraph is indicated with option \textcolor{blue}{in->}
without any value. An input paragraph can contain input programming commands; the
resulting text lines are transmitted to the \textbf{J} function which interprets the input paragraph
\begin{example}[inpuparag]Example of inputparagraph\\
\label{inpuparag}
tr=\textcolor{VioletRed}{trans}()\\
a=\textcolor{VioletRed}{log}(b)\\
\textcolor{VioletRed}{write}(\$,'($\sim$sinlog\,is=$\sim$,f4.0)',\textcolor{VioletRed}{sin}(a))\\
/\\
b=\textcolor{VioletRed}{matrix}(2,3,\textcolor{blue}{in->})\\
1,2,3\\
5,6,7\\
/
\end{example}
\subsection{Command shortcuts}
\label{short}
Command shortcuts are defined by defining character variables. When entering the
name of a character variable at \textcolor{Red}{sit>} prompt or from an include file, \textbf{J} excutes the command.
The command can be either input programming command or ??? command. The file jexamples.inc
shows an useful way to organize shortcuts and include files.
\begin{example}[shortex]Example of using shortcuts and include files\\
\label{shortex}
short1='\textcolor{VioletRed}{sin}(Pi)+\textcolor{VioletRed}{cos}(Pi);'\\
short1\\
te=\textcolor{VioletRed}{text}()\\
this=\textcolor{VioletRed}{thisfile}()\\
ju1='\textcolor{Red}{;incl}(this,\textcolor{blue}{from->}a1)'\\
ju2='\textcolor{Red}{;incl}(this,\textcolor{blue}{from->}a2)'\\
\textcolor{Red}{;return}\\
;a1:\\
'greetings from a1'\\
\textcolor{Red}{;return}\\
;a2:\\
'here, jump to a1';\\
ju1\\
'back here, return to \textcolor{Red}{sit>}'\\
\textcolor{Red}{;return}\\
//\\
\textcolor{VioletRed}{write}('shortex.txt',\$,te)\\
\textcolor{Red}{;incl}(shortex.txt)\\
ju1\\
ju2\\
delete\_f('shortext.txt')\\
te=0 \textcolor{green}{!delete\,also\,text\,object\,te}
\end{example}
\subsection{Input programming}
\label{inpuprog}
The purpose of the input programming is to read or generate \textbf{J} commands or input lines
needed by \textbf{J} functions. The names of input programming commands start with semicolon ';'.
There can be no space between ';' and the following input programming function. The syntax
of input programming commands is the same as in \textbf{J} functions, but the input programming
functions cannot have an output. There are also controls structures in the input programming.
An input paragraph can contain input programming structures.
\subsubsection{Labels in input programming}
\label{inpuad}

The included text files can contain labels. Labels define possible starting points for the
inclusion or jump labels within an include file. A label starts with semicolon (;) and
ends with colon (:). There cannot be other text but not commands on the label line.

\\
;ad1:  At this point we are doing thit and that
\\


\begin{note}
The definition of a transformations object can also contain labels. These labels start
with a letter and end also with colon (:). When defining a transformation object with \textcolor{VioletRed}{trans}() function,
the input paragraph can contain input programming addresses and code labels. It is up to
input programming what code alabels become part of the transformation object.
\end{note}


\subsubsection{Changing “i” sequences}
\label{inpureplace}
If an original input line contains text within quotation marks, then the sequence will be replaced
as follows. If a character variable is enclosed, then the value of the character variable is
substituted: E.g.
directory='D:$\backslash$j$\backslash$'
name='area1'
extension='svs'
then
\textcolor{blue}{in->}'"directory""name"."extension"'
is equivalent to
\textcolor{blue}{in->}'D:$\backslash$j$\backslash$area1.svs'
If the "-expression is not a character variable then \textbf{J} interprets the sequence as an arithmetic
expression and computes its value. Then the value is converted to character string and
substituted into the place. E.g. if nper is variable having value 10, then lines
\color{Green}
\begin{verbatim}
x#"nper+1"#"nper" = 56
chv = 'code"nper"'
\end{verbatim}
\color{Black}
are translated into
\color{Green}
\begin{verbatim}
x#11#10 = 56
chv = 'code10'
\end{verbatim}
\color{Black}

With " " substitution one can define general macros which will get specific interpretation by
giving values for character and numeric parameters, and numeric parameters can be utilized in
variable names or other character strings. In transformation sets one can shorten computation
time by calculating values of expressions in the interpretation time instead of doing
computations repeatedly. E.g. if there is in a data set transformation
x3 = "\textcolor{VioletRed}{sin}(Pi/4)"*x5
Then evaluation of \textcolor{VioletRed}{sin}(Pi/4) is done immediately, and the value is transmitted to the
transformation set as a real constant.
If value of the expression within a “” sequence is an integer then the value is dropped in the
place without the decimal point and without any spaces, otherwise its value is presented in
form which is dependent on magnitude of the value. After J3.0 the format can be explicitly
specified within [] before the numeric value. Eg. text can be put into a figure as
fig =
\textcolor{VioletRed}{drawline}(5,5,\textcolor{blue}{mark->}’y=”[f5.2]coef(reg,x1)“*x1+”[f5.2]coef(reg,1)“‘)
See file jex.txt and Chapter 8 for an ex
\subsubsection{\textcolor{Red}{;incl}()}\index{;incl}
\label{incl}
Includes lines from a file or from a text object. Using the \textcolor{blue}{from->}
option the include file can contain sections which start with adresses like
;ad: \\
and end with \\
\textcolor{Red}{;return}

\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent Args  \tabto{3cm}  0|1  \tabto{5cm}   Ch|Tx  \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent   file name. Default: the same file is used as in the previous \textcolor{Red}{;incl}().he
\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent \textcolor{blue}{from}  \tabto{3cm}  N|1  \tabto{5cm}   Ch  \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent gives the starting \textcolor{blue}{in->} label for the inclusion, label is given without starting ';'
and ending ':'.
\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent \textcolor{blue}{wait} \tabto{3cm}  N|0  \tabto{5cm}    \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent  \textbf{J} waits until the include file can be opened. Useful in client server applications.
See chapter \textbf{J} as a server.
\end {changemargin}
\hline
\vspace{0.2cm}
\begin{note}
Include files can be nested up to 4 levels.evels
\end{note}
\begin{note}
See Chapter Defining a text object with text function and using it in \textcolor{Red}{;incl} how to include
commands from a text object.
\end{note}
\begin{note}
When editing the include file with Notepad ++, it is reasonable to set the language as Fortran (free form).
\end{note}
\begin{example}[inpuincl]Example of \textcolor{Red}{;incl}()\\
\label{inpuincl}
file=\textcolor{VioletRed}{text}()\\
i=1;\\
\textcolor{VioletRed}{goto}(ad1)\\
i=2;\\
ad1:i=66;\\
\textcolor{VioletRed}{goto}(ad2,ad3,2) \,\textcolor{green}{!select\,label\,from\,a\,label\,list}\\
ad2:\\
i=3;\\
ad3:i=4;\\
\textcolor{VioletRed}{goto}(5) \,\textcolor{green}{!select\,label\,from\,the\,list\,of\,all\,labels}\\
ad4:i=5;\\
ad5:i=6;\\
//\\
\textcolor{VioletRed}{write}('file.txt',file)\\
\textcolor{VioletRed}{close}('file.txt')\\
\textcolor{Red}{;incl}(file.txt)\\
\textcolor{Red}{;incl}(file.txt,\textcolor{blue}{from->}ad2)
\end{example}
\begin{note}
The adress line can contain comment starting with '!'.
\end{note}
\subsubsection{\textcolor{Red}{;goto}()}\index{;goto}
\label{inpugoto}
Go to different adress in \textcolor{Red}{;incl}() file.
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent Args \tabto{3cm} 1 \tabto{5cm}  CHAR \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent  The label from which the reading continues. With \textcolor{Red}{;goto}('adr1')
the adress line starts ;adr1:
\end {changemargin}
\hline
\vspace{0.2cm}
\begin{example}[inpugotoex]Example of \textcolor{Red}{;goto}() and \textcolor{Red}{;incl}()\\
\label{inpugotoex}
gototxt=\textcolor{VioletRed}{text}()\\
'Start jumping';\\
\textcolor{Red}{;goto}(ad2)\\
;ad1:\\
'Greetings from ad1';\\
\textcolor{Red}{;return}\\
;ad2:\\
'Greetings from ad2';\\
\textcolor{Red}{;goto}(ad1)\\
//\\
\textcolor{VioletRed}{print}(gototxt)\\
\textcolor{VioletRed}{if}(exist\_f('goto.txt')delete\_f('goto.txt')\\
\textcolor{VioletRed}{write}('goto.txt',gototxt)\\
\textcolor{VioletRed}{close}('goto.txt')\\
\textcolor{VioletRed}{print}('goto.txt')\\
\textcolor{Red}{;incl}(goto.txt)\\
\textcolor{Red}{;incl}(goto.txt,\textcolor{blue}{from->}ad1)\\
delete\_f('goto.txt')
\end{example}
\subsubsection{\textcolor{Red}{;return} returns from include file}\index{;return}
\label{inpureturn}
\textcolor{Red}{;return} in an input file means that the control returns to the point where a
jumpt to an label was found. Two different cases need to be separated:
\begin{itemize}
\item[\textbf{J}] The conrol came to the starting address or to the beginning of the include file
from outside the current include file using a \textcolor{Red}{;incl} command. Then \textcolor{Red}{;return} returns the control to upper level include
file or to the \textcolor{Red}{sit>} prompt.
\item[\textbf{J}] The control came to the starting label from within the same include file using
either an explicit \textcolor{Red}{;incl} or \textcolor{Red}{;goto} command or generating these commands commands
with command shortcut.
\end{itemize}
\subsubsection{\textcolor{Red}{;do}()}\index{;do}
\label{inpudo}
Generates new input records and replaces text with other text
using " "  to generate numbers, @list to generate lists of object names
and @\textcolor{VioletRed}{list}(elem) to pick the names of the elements of a list, or
\textcolor{Red}{;sum}() to generate sums and \textcolor{Red}{;dif}() to generate differences.
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent Args \tabto{3cm} 3|4 \tabto{5cm}  Var,Num.. \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent Arguments are: iteration index, starting limit,
final limit and step. First argument must be a variable name and others
can be REAL variables or numeric constants.
\end {changemargin}
\hline
\vspace{0.2cm}
\begin{example}[inpudoex]Examples of \textcolor{Red}{;do}()\\
\label{inpudoex}
\textcolor{Red}{;do}(i,1,2)\\
x"i"="i"*10\\
\textcolor{VioletRed}{print}('Greetings from iteration "i"')\\
\textcolor{Red}{;enddo}\\
\textcolor{VioletRed}{print}(x1,x2)
\color{Green}
\begin{verbatim}
!After dropping out extra text about the processing we get:
<print('Greetings from iteration 1')
'Greetings from iteration 1'
<print('Greetings from iteration 2')
'Greetings from iteration 2'
sit< print(x1,x2)
<print(x1,x2)
x1=   10.000000000000000
x2=   20.000000000000000
\end{verbatim}
\color{Black}
\end{example}
\subsubsection{\textcolor{Red}{;sum}()}\index{;sum}
\label{inpusum}
\textbf{J} can generate text of form part1+part2+...partn into input line using
input programming function ;isum(). The syntax of the function is as follows:\\
\textcolor{Red}{;sum}(i,low,up,step)(text)\\
or \\
\textcolor{Red}{;sum}(i,low,up)\\
Arguments low, up and step must be integers (actually from nonintger values, the
integer part is used) or REAL variables. Thus te valuse cannot be obtained
from arithmetic operations. Sum is useful at least in \textcolor{VioletRed}{problem}() function.
\begin{example}[inpusumex]Example of \textcolor{Red}{;sum}()\\
\label{inpusumex}
su='\textcolor{Red}{;sum}(i,1,5)(a"i"*x")'\\
\textcolor{VioletRed}{print}(su)
\color{Green}
\begin{verbatim}
<print(su)
'a1*x1+a2*x2+a3*x3+a4*x4'
\end{verbatim}
\color{Black}
prob=\textcolor{VioletRed}{problem}()\\
\textcolor{Red}{;sum}(i,1,5)(a"i"*x"i")==max
\color{Green}
\begin{verbatim}
<prob=problem()
prob< a1*x1+a2*x2+a3*x3+a4*x4+a5*x5==max
\end{verbatim}
\color{Black}
\end{example}
\begin{note}
\textcolor{Red}{;dif}()() works similarly for minus
\end{note}
\subsubsection{\textcolor{Red}{;dif}()}\index{;dif}
\label{inpudif}
\textbf{J} can generate text of form part1-part2-...partn into input line using
input programming function \textcolor{Red}{;dif}(). The syntax of the function is as follows:\\
\textcolor{Red}{;dif}(i,low,up,step)(text)\\
or \\
\textcolor{Red}{;dif}(i,low,up)\\
Arguments low, up and step must be integers (actually from nonintger values, the
integer part is used) or REAL variables. Thus te valuse cannot be obtained
from arithmetic operations. \textcolor{Red}{;dif}() is useful at least in \textcolor{VioletRed}{problem}() function.

\begin{note}
\textcolor{Red}{;sum}()() works similarly for plus. See \textcolor{Red}{;sum}() for examples.
\end{note}
\subsubsection{\textcolor{Red}{;pause}}\index{;pause}
\label{inpupause}
Including input from an include file can be interrupted using an input programming
command \textcolor{Red}{;pause} promt or the \textbf{J} function \textcolor{VioletRed}{pause}('<prompt>'). In both cases
the user can give \textbf{J} commands, e.g., print objects, change the value of Printdebug etc.
The difference is that  \textcolor{VioletRed}{pause}('<prompt>') goes first through the interpreted and the interptreted
code is transmitted to the \textbf{J} function driver. In the \textcolor{Red}{;pause}- pause it is possible to
use input programming commands while in \textcolor{VioletRed}{pause}()- pause it is not possible. In both cases, when
an error occurs, the control remains at the pause prompt. If the user is pressing
<return> \textbf{J} continues in the include file. If \textcolor{VioletRed}{pause}() is part of a transformation object,
pressing <return>, the function driver continues in the transformation object.
If the user gives command 'e' or 'end', then \textbf{J} procees similarly as if an error had occured,
i.e. print error messages and returns control to \textcolor{Red}{sit>} -promt.
\subsubsection{\textcolor{Red}{;return} returns from include file}\index{;return}
\label{inpureturn}
\textcolor{Red}{;return} in an input file means that the control returns to the point where a
jumpt to an label was found. Two different cases need to be separated:
\begin{itemize}
\item[\textbf{J}] The conrol came to the starting address or to the beginning of the include file
from outside the current include file using a \textcolor{Red}{;incl} command. Then \textcolor{Red}{;return} returns the control to upper level include
file or to the \textcolor{Red}{sit>} prompt.
\item[\textbf{J}] The control came to the starting label from within the same include file using
either an explicit \textcolor{Red}{;incl} or \textcolor{Red}{;goto} command or generating these commands commands
with command shortcut.
\end{itemize}
\subsection{Generating sequences with ... -construct}
\label{dots}
It is often natural to index object names, and often we need to refer object
names having consecutive index numbers or index letters. In \textbf{J} versions before version 3.0 it
was possible to generate object lists using ... -construct which replaced part of
the input line with the names of objects being between the the object
name before ... and after ... . Now the dots construct is no more done as
part of the input programming but in the interpret subroutine which interprets the
input line and generates the integer vector for function and argument indices.
But as dots work as if it would be part of the input programming, it is presented in this
section. Currently also sequences of integer constants can be generated with dots and
sequences can be from larger to smaller.
\begin{example}[dotsex]Example of dots construct\\
\label{dotsex}
dat=\textcolor{VioletRed}{data}(\textcolor{blue}{read->}(x4...x7),\textcolor{blue}{in->})\\
1,2,3,4\\
11,12,13,14\\
/\\
\textcolor{VioletRed}{stat}(\textcolor{blue}{min->},\textcolor{blue}{max->},\textcolor{blue}{mean->})\\
x3\%mean...x7\%mean;\\
A...D=4...1;\\
Continue=1 \,\textcolor{green}{!demo\,of\,error\,in\,\textcolor{VioletRed}{data}()}\\
dat=\textcolor{VioletRed}{data}(\textcolor{blue}{read->}(x3...x7),\textcolor{blue}{in->})\\
1,2,3,4\\
11,12,13,14\\
/\\
Continue=0
\end{example}
\section{\textbf{J} functions: an overview}
\label{jfuncs}
\textbf{J} functions are organized into 21 groups. Some of of the functions are such that the
interpreter converts the code given by the user into new function names. For instance
the code 1+2 is first changed into \textcolor{VioletRed}{PLUS}(1,2), and code a(3) is changed
into form \textcolor{VioletRed}{getelem}(a,3). The following list contains also such implicit
function names to support also those users who are interested to start looking at
the open source code.
The ordering of functions in this manual is the same as in the file jmodules.f90
in order to make it easier to start looking the source code, even if the order is
not the most logical from the application point of view. When adding new functions into
any group is easy when the new function is put to the end of group so new functions are not inserted
in the middle of group even if it would more logical.
!
\begin{itemize}
\item Special functions
\begin{itemize}
\item setoption
\item getelem
\item setelem
\item list2
\item o1\_funcs
\item o2\_funcs
\item o3\_funcs
\item setcodeopt
\end{itemize}
\item  Objects
\begin{itemize}

\item type
\item delete\_o
\item exist\_o
\item name
\end{itemize}
\item 	Transformations
\begin{itemize}
\item trans
\item call
\item pause
\item noptions
\item R
\end{itemize}

\item  Loops and controls structures
\begin{itemize}
\item do
\item if
\item ASSIGN
\item sit
\item which
\item errexit
\item goto
\item itrace
\item trace
\item tracenow
\item itraceoff
\item traceoff
\item tracetest
\item assone
\item enddo
\item assmany
\item goto2
\item goto3
\end{itemize}

\item Arithmetic and logical operations after converting to the polish notation
\begin{itemize}
\item HMULT
\item HDIV
\item IPOWER
\item MULT
\item DIV
\item PLUS
\item MINUS
\item EQ
\item NE
\item LE
\item LT
\item GE
\item GT
\item NOT
\item AND
\item OR
\item EQV
\item NEQV
\item POWER
\end{itemize}
\item Arithemetic functions which can operate on scalars or on matrices
\begin{itemize}
\item max
\item sign
\item mod
\item nint
\item int
\item ceiling
\item floor
\item sqrt
\item sqrt2
\item log10
\item exp
\item sin
\item sind argument is in degrees, also in the following
\item cos
\item cosd
\item tan
\item tand
\item cotan
\item cotand
\item asin
\item asind
\item acos
\item acosd
\item atan
\item atand
\item acotan
\item acotand
\item sinh
\item cosh
\item tanh
\item fraction
\item abs
\end{itemize}

\item  Special arithemetic functions
\begin{itemize}
\item der
\item gamma
\item loggamma
\item logistic
\item npv
\end{itemize}

\item  Probability distributions
\begin{itemize}
\item pdf
\item cdf
\item bin
\item negbin
\item density
\end{itemize}
\item Random numbers
\begin{itemize}
\item ran
\item rann
\item ranpoi
\item ranbin
\item rannegbin
\item select
\item random
\end{itemize}
\item Interpolation
\begin{itemize}
\item interpolate
\item plane
\item bilin
\end{itemize}

\item  List functions
\begin{itemize}
\item  list
\item merge
\item difference
\item index
\item index\_v
\item len
\item ilist
\item putlist
\end{itemize}
\item  Creating a text  object
\begin{itemize}
\item text
\item txt
\end{itemize}
\item File handling
\begin{itemize}
\item exist\_f
\item delete\_f
\item close
\item showdir
\item setdir
\item thisfile
\item filestat
\item read
\item write
\item print
\item ask
\item askc
\item printresult
\item printresult2
\end{itemize}

\item  Matrices
\begin{itemize}
\item matrix
\item nrows
\item ncols
\item t
\item inverse
\item solve
\item qr
\item eigen
\item sort
\item envelope
\item ind
\item mean
\item sum
\item var
\item sd
\item minloc
\item maxloc
\item cumsum
\item corrmatrix
\end{itemize}

\item  Data functions
\begin{itemize}
\item data
\item newdata
\item exceldata
\item linkdata
\item getobs
\item nobs
\item classvector
\item values
\item transdata
\end{itemize}

\item  Statistical functions
\begin{itemize}
\item stat
\item cov
\item corr
\item regr
\item mse
\item rmse
\item coef
\item r2
\item se
\item nonlin
\item varcomp
\item classify
\item class
\end{itemize}

\item  Linear programming
\begin{itemize}
\item problem
\item jlp
\item weights
\item unit
\item schedcum
\item schedw
\item weight
\item partweights
\item partunit
\item partschedcum
\item partschedw
\item partweight
\item priceunit
\item weightschedcum
\item priceschedcum
\item priceschedw
\item weightschedw
\item integerschedw
\item xkf
\end{itemize}

\item Plotting figures
\begin{itemize}
\item plotyx
\item draw
\item drawclass
\item drawline
\item show
\item plot3d
\end{itemize}
\item Splines, stem splines,  and volume functions
\begin{itemize}
\item tautspline
\item stemspline
\item stempolar
\item laasvol
\item laaspoly
\item integrate
\end{itemize}

\item Bit functions
\begin{itemize}
\item setbits
\item clearbits
\item getbit
\item getbitch
\item bitmatrix
\item setvalue
\item closures
\end{itemize}

\item  Misc. utility functions
\begin{itemize}
\item value
\item properties
\item cpu
\item seconds
\end{itemize}
\end{itemize}

\section{Special functions}
\label{special}
The special functions are such that the interpreter uses these functions for special operations.
Only \textcolor{VioletRed}{list2}() is function which also the user can use, but the interpreter is
is using it implicitly.
\subsection{\textcolor{VioletRed}{setoption}(): set option on}\index{setoption()}
\label{setoption}
When a function has an option then the interpreter generates first code
\textcolor{VioletRed}{setoption}(...) where the arguments of the option are interpred in the similar way as
arguments of all functions. Then the interpreter genarates the code for
\textcolor{VioletRed}{setoption}() function in a special way.
\subsection{Get or set a matrix element or submratrix}
\label{getelem}
Matrix elements or submatrices can be accessed using the same syntax as
accesing \textbf{J} functions.

One can get or set matrix elements and submatrices as follows. If the expression
is on the right side of '=' then \textbf{J} gets a REAL value or submatrix, if the expression
is on the left side of '=', the \textbf{J} sets new values for a matrix element or a submatrix.
In the following formulas \textcolor{teal}{C} is a column vector, \textcolor{teal}{R} a row vector, and \textcolor{teal}{M} is
a general matrix with m rows and n columns.
If \textcolor{teal}{C} is actually REAL it can
be used as if it would 1 x 1 MATRIX. This can be useful when working with
matrices whose dimensions can vary starting from 1 x 1. Symbol \textcolor{teal}{r} refers to
row index, \textcolor{teal}{r1} to first row in a row range, \textcolor{teal}{r2} to the last row. The rows and
columns can be specifiel using ILIST objects \textcolor{teal}{il1} and \textcolor{teal}{il2} to specify noncontiguous ranges.
It is currently not possible to mix ILIST range and contiguous range, so if ILIST
is needed for rows (columns), it must be used also for columns (rows). ILIST can be
sepcified using explicitly \textcolor{VioletRed}{ilist}() function or using {} construction.
Similarly columns are indicated  with \textcolor{teal}{c}. It is always legal to refer to
vectors by using the \textcolor{teal}{M} formulation and giving \textcolor{teal}{c} with value 1 for column vectors and
and \textcolor{teal}{r} with value 1 for row vectors.
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent Args \tabto{3cm} 0-4 \tabto{5cm}  REAL | ILIST \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent row and column range as explained below.
\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent \textcolor{blue}{diag} \tabto{3cm} N| \tabto{5cm}    \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent Get or set diagonal elements
\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent \textcolor{blue}{sum} \tabto{3cm} N|0|1 \tabto{5cm}    \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent  When setting elements, the right side is added to the current elements. If the
\textcolor{blue}{sum->} option has argument, the right side is multiplied with the argument when adding to the curretn elements.
\end {changemargin}
\hline
\vspace{0.2cm}

Row and column ranges can be spcidie as follows.
\begin{itemize}
\item[\textbf{J}\.] \textcolor{teal}{M}(r,c) \tabto{5cm} Get or set single element.
\item[\textbf{J}\.] \textcolor{teal}{C}(r)  \tabto{5cm} Get or set single element in column vector.
\item[\textbf{J}\.] \textcolor{teal}{R}(c) \tabto{5cm} Get or set single element in column vector.
\item[\textbf{J}\.] \textcolor{teal}{M}(RANGES) \tabto{5cm} Get or set a submatrix, where RANGES
can be. For a column vector, the column range need not to specified.
\begin{itemize}
\item[\textbf{J}\.] r1,-r2,c1,-c2
\item[\textbf{J}\.] r,c1,-c2  \tabto{5cm} part of row r
\item[\textbf{J}\.] r1,-r2,c	\tabto{5cm} part of column c
\item[\textbf{J}\.] r1,-r2,All  \tabto{5cm} All columns of the row range
\item[\textbf{J}\.] All,c1,-c2  \tabto{5cm} All rows of the column range
\item[\textbf{J}\.] {r1,....rm},{c1,...,cn}  \tabto{5cm} Given rows and columns
\item[\textbf{J}\.] {r1,....rm}  \tabto{5cm} Given rows for column vector
\item[\textbf{J}\.] il1,il2   \tabto{5cm} for matrix with several columns
\item[\textbf{J}\.] il1   \tabto{5cm} for column vector
\end{itemize}
\item[\textbf{J}\.] When r2= m, then -r2 can be replaced with \textcolor{teal}{Tolast}.
\item[\textbf{J}\.] When c2= n, then -c2 can be replaced with \textcolor{teal}{Tolast}.
\end{itemize}

If option \textcolor{blue}{diag->} is present then
\begin{itemize}
\item[\textbf{J}\.] \textcolor{teal}{M}(\textcolor{blue}{diag->}) Get or set the diagonal. If \textcolor{teal}{M} is not square matrix, and error
occurs.
\item[\textbf{J}\.] \textcolor{teal}{M}(r1,-r2,\textcolor{blue}{diag->}) (Again -r2 can be \textcolor{teal}{Tolast}.
\end{itemize}
\begin{note}
Note
When setting values to a submatrix the the the values given in input matrix
are put into the outputmatrix in row order, and the shape of the input and output matrices need
not be the same. An error occurs only if input and output contain different number of
elements.
\end{note}
\begin{example}[getset]Get or set submatrices\\
\label{getset}
A=\textcolor{VioletRed}{matrix}(3,4,\textcolor{blue}{do->});\\
B=A(1,-2,3,-4);\\
A(1,-2,3,-4)=B+3;\\
A(1,-2,3,-4,\textcolor{blue}{sum->})=-5;\\
A(1,-2,3,-4,\textcolor{blue}{sum->}2)=A(2,-3,1,-2,\textcolor{blue}{sum->}2);\\
C=A({1,3},{4...2});\\
H=\textcolor{VioletRed}{matrix}(4,4,\textcolor{blue}{diag->},\textcolor{blue}{do->}3);\\
H(3,-4,\textcolor{blue}{diag->})=\textcolor{VioletRed}{matrix}(2,\textcolor{blue}{values->}(4,7));
\end{example}
\begin{note}
When giving range, the lower and upper limit can be equal.qual
\end{note}
\subsection{\textcolor{VioletRed}{setelem}(): Putting something  into an object.}\index{setelem()}
\label{setelem}
The origin of this function is the function which was used in previous versions
to set an matrix element, which explains the name. Now it is used to replace values
of submatrices when submatrix expression is on the
output side (e.g. a(1,-3,All)=..).
\begin{note}
If someone starts to use the own function property of the open source J, she/he
probably would like to get the possiblity to put information into from her/his object types
also. To implement this property requires some co-operation from my side.
\end{note}
\begin{note}
In effect the \textcolor{VioletRed}{getelem}() and \textcolor{VioletRed}{setelem}() functions are excuted in the same
\textcolor{VioletRed}{getelem}() subroutine, because bot functions can utilize the same code.
\end{note}
\subsection{\textcolor{VioletRed}{list2}()}\index{list2()}
\label{list20}
The interpreted utilizes this to separate when spearating output and input objects.
See Section \ref{list2} hw user can use this function
\subsection{setcode(): Initialization of a code option}
\label{setcode}
This function initializes an code option for a function which has the option.
\subsection{Own functions:  o1\_o1\_funcs(), o2\_funcs() and o3\_funcs()}
\label{own}
The users of open \textbf{J} can define their own functions using three
available own-function sets. In addition to own functions open \textbf{J} is ready to
recognize also own object types and options which are defined in the source files
controlled by the users. The main \textbf{J} does not know what to do with these own
object types and options, they are just transmitted to the own-functions.
In the main \textbf{J} the control is transmitted to the own functions using
\textbf{J} functions o1\_o1\_funcs(), o2\_funcs() and o3\_funcs().
\section{Functions for handling objects}
\label{objects}
The following functions can handle objects.
\subsection{Get type of an object: \textcolor{VioletRed}{type}()}\index{type()}
\label{type}
\textcolor{green}{!\,The\,index\,of\,any\,object\,can\,be\,access\,by\,\textcolor{VioletRed}{type}(\textcolor{teal}{object}).}
\textcolor{green}{!\,If\,the\,argument\,is\,a\,character\,variable\,or\,character\,constant\,referring\,to}
\textcolor{green}{!\,a\,character\,constant,\,and\,there\,is\,\textcolor{blue}{content->}\,option,\,and\,the\,character\,is\,the\,name\,of}
an object , the \textcolor{VioletRed}{type}() returns the type of the object having the name given in the argument.
If there is no object having taht name, then \textcolor{VioletRed}{type}() returns -1 and no error is generated.
\begin{example}[typeex]Example of type\\
\label{typeex}
ttt=8; \,\,\textcolor{green}{!REAL}\\
\textcolor{VioletRed}{type}(ttt);\\
\textcolor{VioletRed}{type}('ttt'); \textcolor{green}{!type\,is\,CHAR}\\
\textcolor{VioletRed}{type}('ttt',\textcolor{blue}{content->});\\
cttt='ttt'\\
\textcolor{VioletRed}{type}(cttt);\\
\textcolor{VioletRed}{type}(cttt,\textcolor{blue}{content->});
\end{example}
\subsection{Deleting objects: delete\_o()}
\label{delete}
When an object with a given name is created, the name cannot be removed. With
delete\_0() function one can free all memory allocated for data structures needed
by general objects:
delete\_o(obj1,…,objn)
After deleting an object, the name refers to a real variable (which is
initialized by the delete\_o() function into zero).
\begin{note}
Other objects except matrices can equivalently be deleted by giving
command
obj1,…,objn = 0
This is because the output objects of any functions are first deleted before
defining them anew. Usually an object is automatically deleted if the object
name is as an output object for other functions.
\end{note}
\begin{note}
One can see how much memory each object is using \textcolor{VioletRed}{print}(Names).mes
\end{note}
\begin{note}
Deleting a compound object deletes also such
subobjects which have no meaning when the main object is deleted. But e.g. if a
data object is deleted then the as-sociated transformation object is not
deleted as the transformation can be used independently.
\end{note}
\begin{note}
Files can be deleted with delete\_f(file). See IO-functions for
details.
\end{note}
\begin{note}
If the user has defined own new compound objects in the open source
\textbf{J} software she/he needs to define the associated delete function.
\end{note}
\subsection{_o exist\_o(): does an object exist}
\label{exist}
looks whether an object with the name given in
the character constant  argument exists.
\begin{note}
In the prvious versions of \textbf{J} same function was used for files and objects.
\end{note}
\subsection{\textcolor{VioletRed}{name}(): writes the name of an object}\index{name()}
\label{name}
The argument gives the index of the object. This function
may useful if \textbf{J} prints in problem cases the object indices.
\section{Transformation objects}
\label{Transformations}
The code lines generated by the input programming can be either
executed directly after interpretation, or the interpreted code lines
are packed into a transformation object, which can be excuted with \textcolor{VioletRed}{call}()
which is either in the code generated with the input programming
or inside the same or other transformation object. Recursive
calling a transformation is thus also possible. Different functions
related to transformation object are described in this section.
\subsection{Generating a transformation object \textcolor{VioletRed}{trans}()}\index{trans()}
\label{trans}
\textcolor{VioletRed}{trans}() function interprets lines from input paragraph following the \textcolor{VioletRed}{trans}() command and puts the
interpreted code into an integer vector, which can be excuted in several places.
If there are no arguments in the function, the all objected used within the
transforamations are global. This may cause conflicts if there are several recursive
functions operating at the same time with same objects. \textbf{J} checks some of
these conflict situations, but not all.  These conflicts can be avoided by giving
intended global arguments  in the list of arguments.
Then an object 'ob' created e.g. with transformation object \textcolor{teal}{tr} have prefix
]tr$\backslash$[ yelding ]tr$\backslash$ob[. Actually also these objects are global, but their prefix
protects them so that they do not intervene with objects having the same name in the
calling transformation objec.

Each line in the input paragraph is read and interpreted and packed into a transformation
object, and associated tr\%input and tr\%output lists are created for input and output
variables. Objects can be in both lists. Objects having names starting
with '\$' are not put into the input or output lists. The source code is saved in a text object
tr\%source. List tr\%arg contains all arguments.
!
If a semicolon ';'  is at the end of an input line, then
the output is printed if REAL variable Prindebug has value 1 or value>2 at
the execution time. If the double semicolon ';;' is at the end then the output is
printed if Printresult>1. If there is no output, but just list of objects, then these
objects will be printed with semicolns.

!
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent Output \tabto{3cm} 1 \tabto{5cm}  Data \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent The TRANS object generated.
\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent Args \tabto{3cm} N|1- \tabto{5cm}    \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent  Global objects.
\end {changemargin}
\hline
\vspace{0.2cm}
\begin{note}
Options \textcolor{blue}{input->}, \textcolor{blue}{local->}, \textcolor{blue}{matrix->}, \textcolor{blue}{arg->}, \textcolor{blue}{result->}, \textcolor{blue}{source->} of previous
versions are obsolte.
\end{note}
\begin{note}
The user can intervene the execution from console if the code calls \textcolor{VioletRed}{read}(\$,),
\textcolor{VioletRed}{ask}(), \textcolor{VioletRed}{askc}() or \textcolor{VioletRed}{pause}() functions. During the pause one can give any command excepts
such input programming command as \textcolor{Red}{;incl}.
\end{note}
\begin{note}
The value of Printresult can be changed in other parts of the transformation, or
in other transforamations called or during execution of \textcolor{VioletRed}{pause}().
\end{note}

\begin{note}
Output variables in \textcolor{blue}{maketrans->} transformations whose name start with \$ are not put into the new data object.
\end{note}
\begin{example}[transex]Demonstrates also error handling\\
\label{transex}
tr=\textcolor{VioletRed}{trans}()\\
\$x3=x1+3\\
x2=2/\$x3;\\
/\\
tr\%input,tr\%output,tr\%source;\\
x1=8\\
\textcolor{VioletRed}{call}(tr)\\
tr2=\textcolor{VioletRed}{trans}(x1,x2)\\
\$x3=x1+3\\
x2=2/\$x3;\\
x3=x1+x2+\$x3;\\
/\\
tr2\%input,tr2\%output,tr2\%source;\\
\textcolor{VioletRed}{call}(tr2)\\
tr2\x3; \,\,\textcolor{green}{!x3\,is\,now\,local}\\
tr3=\textcolor{VioletRed}{trans}()\\
x1=-3\\
\textcolor{VioletRed}{call}(tr) \textcolor{green}{!this\,is\,causing\,division\,by\,zero}\\
/\\
Continue=1 \,\,\textcolor{green}{!\,continue\,after\,error}\\
\textcolor{VioletRed}{call}(tr3)
\end{example}
\color{Green}
\begin{verbatim}
sit>transex
<;incl(exfile,from->transex)


<tr=trans()
<$x3=x1+3
<x2=2/$x3;
</
<tr%input,tr%output,tr%source;
tr%input is list with            2  elements:
x1 $x3
tr%output is list with            1  elements:
x2
tr%source is text object:
1 $x3=x1+3
2 x2=2/$x3;
3 /
///end of text object

<x1=8


<call(tr)
x2=0.18181818

<tr2=trans(x1,x2)
<$x3=x1+3
<x2=2/$x3;
<x3=x1+x2+$x3;
</
<tr2%input,tr2%output,tr2%source;
tr2%input is list with            1  elements:
x1
tr2%output is list with            1  elements:
x2
tr2%source is text object:
1 $x3=x1+3
2 x2=2/$x3;
3 x3=x1+x2+$x3;
4 /
///end of text object

<call(tr2)
x2=0.18181818

tr2\x3=19.1818181

<tr2\x3;
tr2\x3=19.1818181

<tr3=trans()
<x1=-3
<call(tr)
</
<Continue=1
<call(tr3)
*division by zero
*****error on row            2  in tr%source
x2=2/$x3;
recursion level set to    3.0000000000000000

*****error on row            2  in tr3%source
call(tr)
recursion level set to    2.0000000000000000

*err* transformation set=$Cursor$
recursion level set to    1.0000000000000000
****cleaned input
call(tr3)
*Continue even if error has occured
<;return
\end{verbatim}
\color{Black}
\subsection{Excuting transformation object explicitly \textcolor{VioletRed}{call}()}\index{call()}
\label{call}

Interpreted transformations in a transformation object can be automatically executed by other \textbf{J}
functions or they can be executed explicitly using \textcolor{VioletRed}{call}() function.

\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent Arg \tabto{3cm} 1 \tabto{5cm}  TRANS \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent  The transformation object executed.
\end {changemargin}
\hline
\vspace{0.2cm}

\begin{note}
A transformation objects can be used recursively, i.e. a transformation can be called from
itself. The depth of recursion is not controlled by J, so going too deep in recursion will
eventually lead to a system error.
\end{note}
\begin{example}[recursion]Recursion produces system crash.\\
\label{recursion}
tr=\textcolor{VioletRed}{trans}() \textcolor{green}{!level\,will\,be\,initialized\,as\,zero}\\
level;\\
level=level+1\\
\textcolor{VioletRed}{call}(tr)\\
/\\
Continue=1 \,\textcolor{green}{!error\,is\,produced}\\
\textcolor{VioletRed}{call}(tr)\\
Continue=0
\end{example}
\subsection{Pause: \textcolor{VioletRed}{pause}()}\index{pause()}
\label{pause}
Function \textcolor{VioletRed}{pause}() stops the execution of \textbf{J} commands which are either in an
include file or in TRANS object. The user can give any commands during the
\textcolor{VioletRed}{pause}() except input programming commands.
If the user presses <return> the excution continues. If the user gives 'e', then
an error condition is generated, and \textbf{J} comes to the \textcolor{Red}{sit>} promt, except
if \textcolor{teal}{Continue} has values 1, in which case the control returns one level above
the \textcolor{Red}{sit>} promt.
If \textcolor{VioletRed}{pause}()  has a CHAR argument, then that character constant is used as
the prompt.
\begin{note}
When reading commands from an include file, the a pause can be generated also
with \textcolor{Red}{;pause}, which works similarly as \textcolor{VioletRed}{pause}(), but during \textcolor{Red}{;pause} also input programming
commands can be given.
\end{note}
\subsection{Number of options in the current function: \textcolor{VioletRed}{noptions}()}\index{noptions()}
\label{noptions}
\textcolor{VioletRed}{noptions}() returns as a REAL value the number of options currently
active. This may be used for testing purposes.
\begin{note}
When \textbf{J} processes options in different funtions, it varies at which point
options are cleared and number of options decreases
\end{note}
\subsection{executing an R-script: \textcolor{VioletRed}{R}()}\index{R()}
\label{R}
An R script can be executed with \textcolor{VioletRed}{R}(script) where script is CHAR object
defining the script text file. The function is calling //
call execute\_command\_line('Rscript.lnk '//j\_filename(1:le), wait=.false.)//
Thus a shortcut for the Rscript program needs to be available.
\begin{example}[Rex]Example of Rscript\\
\label{Rex}
rscript=\textcolor{VioletRed}{text}()\\
\# A simple R-script that generates a small data to file mydat.txt\\
wd<-"C:/j3/"\\
x<-runif(10,0,10)\\
y<-cbind(1,x)\%*\%c(1,2)+rnorm(10)\\
mydat<-data.frame(y,x)\\
write.table(mydat,file=paste(wd,"/mydat.txt",sep=""))\\
//\\
\textcolor{VioletRed}{write}('miniscript'.r',rscript)\\
\textcolor{VioletRed}{close}('miniscript.r)\\
\textcolor{VioletRed}{R}('miniscript.r')\\
\textcolor{VioletRed}{print}('mydat.txt')
\end{example}







\section{Loops and control strucures}
\label{loops}
This section describes nonstadard functions.
\subsection{\textcolor{VioletRed}{do}() loops}\index{do()}
\label{do}

The loop construction in \textbf{J} looks as follows:
\\
\textcolor{VioletRed}{do}(i,start,end[,step])
\\
enddo
\\
\begin{note}
cycle and exit are implemented in the current \textbf{J} version with \textcolor{VioletRed}{goto}()oto
Within a do–loop there can be cycleand exitdostatements
\end{note}
\begin{note}
There can be 8 nested loops. do-loop is not allowed at command level.evel
\end{note}
\begin{example}[doex]do-loop\\
\label{doex}
'begin';\\
tr=\textcolor{VioletRed}{trans}()\\
\textcolor{VioletRed}{do}(i,1,5)\\
i;\\
ad1: \textcolor{VioletRed}{if}(i.eq.3)\textcolor{VioletRed}{goto}(cycle)\\
i;\\
\textcolor{VioletRed}{if}(i.eq.4)\textcolor{VioletRed}{goto}(jump)\\
cycle:enddo\\
jump:i;\\
\textcolor{green}{!\textcolor{VioletRed}{goto}(ad1)\,\,!\,it\,is\,not\,allowed\,to\,jump\,into\,a\,loop}\\
/\\
\textcolor{VioletRed}{call}(tr)
\end{example}
\subsection{\textcolor{VioletRed}{if}()}\index{if()}
\label{if}

\textcolor{VioletRed}{if}()j\_statement… \newline
The one line if-statement.
\subsection{assignment: \textcolor{teal}{output}=\textcolor{teal}{input}}
\label{ASSIGN}
There are two assignment functions generated by '=', when the line is of
form \textcolor{teal}{output}=func[]input[), then the output is directly
put to the output position of the function
without explicitly generating assignment.
When the codeline is in form \textcolor{teal}{output}=\textcolor{teal}{input} then the following cases can occur

\begin{itemize}
\item[\textbf{J}]  \textcolor{teal}{output} is MATRIX
and \textcolor{teal}{input} is scalar, then each element of MATRIX is replaced with the \textcolor{teal}{input}
in \textcolor{VioletRed}{assone}() function.
\item[\textbf{J}]  \textcolor{teal}{output} is submatrix expression, then the elements of the
submatrix are asigned in \textcolor{VioletRed}{setelem}() funtion whether \textcolor{teal}{input} is MATRIX or submatrix
expression, scalar or LIST.

\item[\textbf{J}]  \textcolor{teal}{output} is MATRIX  and on input side is a random number
generation function, the random numbers are put to all elements of the matrix.

\item[\textbf{J}] If on output side are many object names, and input side is
one REAL value, this is put to all variables.

\item[\textbf{J}] If on output side are many object names, and input there are several
variables then both sides should have equal numbers of object names, then
then copies of the input objects are put into output objects.


\end{itemize)
\begin{example}[assignex]Examples of assignments\\
\label{assignex}
a=\textcolor{VioletRed}{matrix}(2,3);\\
a=4;\\
a=\textcolor{VioletRed}{rann}();\\
v1...5=2...6;\\
v1...5=77;\\
Continue=1 \,\textcolor{green}{!\,ERROR}\\
v1..3=1,5;\\
Continue=0
\end{example}
\subsection{Selecting a value based on conditions. Usage://}
\label{which}

output=\textcolor{VioletRed}{which}(condition1,value1,...,conditionn,valuen) //
or//
output=\textcolor{VioletRed}{which}(condition1,value1,...,conditionn,valuen,valuedefault)
Where conditionx is a REAL value, nonzero	value indicating TRUE. Output will get first value for which
the condition is TRUE. When the number of arguments is not even, the the last value
is the default value.
\begin{example}[whichex]Example of \textcolor{VioletRed}{which}()\\
\label{whichex}
c=9\\
\textcolor{VioletRed}{which}(a.eg.3.or.c.gt.8,5,a.eq.7,55);\\
a=7\\
\textcolor{VioletRed}{which}(a.eg.3.or.c.gt.8,5,a.eq.7,55);\\
a=5\\
\textcolor{VioletRed}{which}(a.eg.3.or.c.gt.8,5,a.eq.7,55);\\
\textcolor{VioletRed}{which}(a.eg.3.or.c.gt.8,5,a.eq.7,55,108);
\end{example}
\subsection{\textcolor{VioletRed}{errexit}()}\index{errexit()}
\label{errexit}
Function \textcolor{VioletRed}{errexit}() returns the control to \textcolor{Red}{sit>} prompt with a message similarly
as when an error occurs.

\begin{example}[errexitex]itex\\
\label{errexitex}
tr=\textcolor{VioletRed}{trans}()\\
\textcolor{VioletRed}{if}(a.eq.0)\textcolor{VioletRed}{errexit}('illegal value ',a)\\
s=3/a; \textcolor{green}{!\,division\,with\,zero\,is\,teste\,automatically}\\
/\\
a=3.7\\
\textcolor{VioletRed}{call}(tr)\\
tr(s); \textcolor{green}{!tr\,can\,also\,be\,used\,as\,a\,function}\\
a=0\\
Continue=1 \,\textcolor{green}{!Do\,not\,stop\,in\,thsi\,seflmade\,error}\\
\textcolor{VioletRed}{call}(tr)\\
Continue=0
\end{example}
\subsection{\textcolor{VioletRed}{goto}()}\index{goto()}
\label{goto}
Control can be transfered to a line in a transformation set with \textcolor{VioletRed}{goto}().
\begin{example}[gotoex]\\
\label{gotoex}
tr=\textcolor{VioletRed}{trans}()\\
i=0\\
\textcolor{VioletRed}{if}(i.eq.0)\textcolor{VioletRed}{goto}(koe)\\
'here';\\
koe:ch='here2';\\
/\\
\textcolor{VioletRed}{call}(tr)\\
ch;

\end{example}

\begin{note}
It is not allowed to jump in to a loop or into if -then structure. This is
checked already in in the interpreter.
\end{note}
\begin{note}
It is not yet possible to continue within an include file using Continue=1.
\end{note}
\begin{note}
It is not recommended to use \textcolor{VioletRed}{goto}() according to modern computation practices.
However, it was easier to implement cycle and exitdo with \textcolor{VioletRed}{goto}(), especially if
cycle or exitdo does not apply hte innermost do-loop.
\end{note}
\section{Arithmetic and logical operations}
\label{arit}
\textcolor{green}{!The\,arithmetic\,and\,logical\,operations\,are\,first\,converted\,into\,the\,polish\,notation.}
The logical operations follow the same ruels as addition +. The following rules,
extending the standard matrix computaion rules apply. The same rules aplly if the
order of arguments is changed,
\begin{itemize}
\item[\textbf{J}] MATRIX + REAL : REAL is added to each element

\item[\textbf{J}] MATRIX1+MATRIX2 :: elementwise addition, if matrices hav comptaible dimensions
\item[\textbf{J}]  MATRIX+ column vector: column vector is added to each column of MATRIX
if the numbers of rows agrees.
\item[\textbf{J}]  MATRIX+ row vector: row vector is added to each
row of MATRIX
if the numbers of columns agree.

\end{itemize}
The same rules apply for the lelmentwise multiplication *. and elementwise
division /. as for addition +.
\subsection{Minimum and maximum: \textcolor{VioletRed}{min}() and \textcolor{VioletRed}{max}}\index{min()max()}
\label{minmax}
Functions \textcolor{VioletRed}{min}() and max ()
behave in a special way, \textcolor{VioletRed}{max}() behaves similarly as \textcolor{VioletRed}{min}() here:
\begin{itemize}
\item[\textbf{J}] \textcolor{VioletRed}{min}(x1,x2):: minimum of two REAL
\item[\textbf{J}] \textcolor{VioletRed}{min}(MATRIX,REAL):: each element is \textcolor{VioletRed}{min}(elem,REAL)
\item[\textbf{J}] \textcolor{VioletRed}{min}(MATRIX):: row vector having minimums of all columns
\item[\textbf{J}] \textcolor{VioletRed}{min}(MATRIX,\textcolor{blue}{any->}):: minimum over the whole amtrix
\end{itemize}
\section{Statistical functions for matrices}
\label{matrixstat}
Functions \textcolor{VioletRed}{mean}(), \textcolor{VioletRed}{sd}(), \textcolor{VioletRed}{var}(), \textcolor{VioletRed}{sum}(), \textcolor{VioletRed}{min}() and \textcolor{VioletRed}{max}()
can be used used to compute stastics from a matrix. Let \textcolor{VioletRed}{mean}() here present
any of thes functions. The following rules apply:
\begin{itemize}
[\textbf{J}\.] \textcolor{VioletRed}{mean}(VECTOR) computes the mean of the vector, output is REAL
[\textbf{J}\.] \textcolor{VioletRed}{mean}(MATRIX) computes the mean of the each column. Result is row vector.
[\textbf{J}\.] \textcolor{VioletRed}{mean}(VECTOR,\textcolor{blue}{weight->}wvector) computes the
weigted mean of the vector,weights being in vector wvector.
[\textbf{J}\.] \textcolor{VioletRed}{mean}(MATRIX,\textcolor{blue}{weight->}wvector) computes the
weighted mean of each column, weights being in vector wvector, result is row vector.

\end{itemize}
\section{Special arithmetic functions}
\label{Special}
\textbf{J} has the following arithmetic functions producing REAL values.These functions cannot yet have
matrix arguments.
\subsection{Derivatives with \textcolor{VioletRed}{der}()}\index{der()}
\label{der}
Derivates of a function with respect to any of its arguments can be
computed using the derivation rules by using \textcolor{VioletRed}{der}() function in the previous line. The funcion must be expressed with
one-line statement. The function can call other functions using the standard way
to obtain objects from transformations, but these functions cannot
contain variables for which derivatives are obtained.
Nonlinear regression needs the derivatives with respect to the parameters.
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent Output  \tabto{3cm}    \tabto{5cm}     \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent  The \textcolor{VioletRed}{der}() function does not have an explicit output, but
\textcolor{VioletRed}{der}() accompanied with the function produces REAL ]d[[] variable for each of the
argument variables.
\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent Args  \tabto{3cm} 1-  \tabto{5cm}   REAL  \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent   ]d[[Argi] variable will get the value of the derivative wiht
respect to the argument \textcolor{teal}{Argi}.
\end {changemargin}
\hline
\vspace{0.2cm}
\begin{example}[derex]Derivatives with \textcolor{VioletRed}{der}()\\
\label{derex}
tr=\textcolor{VioletRed}{trans}()\\
\textcolor{VioletRed}{der}(x)\\
f=(1+x)*cos(x)\\
/\\
fi=\textcolor{VioletRed}{draw}(\textcolor{blue}{func->}tr(d[x]),\textcolor{blue}{x->}x,\textcolor{blue}{xrange->}(0,10),\textcolor{blue}{color->}Blue,\textcolor{blue}{continue->})\\
fi=\textcolor{VioletRed}{draw}(\textcolor{blue}{func->}tr(f),\textcolor{blue}{x->}x,\textcolor{blue}{xrange->}(0,10),\textcolor{blue}{color->}Cyan,\textcolor{blue}{append->},\textcolor{blue}{continue->}fcont)
\end{example}
\begin{example}[derex2]2\\
\label{derex2}
X=\textcolor{VioletRed}{matrix}(\textcolor{blue}{do->}(0,1000,10))\\
e=\textcolor{VioletRed}{matrix}(\textcolor{VioletRed}{nrows}(X))\\
e=\textcolor{VioletRed}{rann}(0,2);\\
A,Pmax,R=0.1,20,2\\
A*Pmax*1000/(A*1000+Pmax);\\
Y=A*Pmax*X/.(A*X+Pmax)-R+e \,\textcolor{green}{!rectangular\,hyperbola\,used\,often\,for\,photosynthesis}
\\
rect=\textcolor{VioletRed}{trans}()\\
\textcolor{VioletRed}{der}(A,Pmax,R)\\
f=A*Pmax*I/(A*I+Pmax)-R\\
/
\\
fi=\textcolor{VioletRed}{draw}(\textcolor{blue}{func->}(rect(f)),\textcolor{blue}{x->}I,\textcolor{blue}{xrange->}(0,1000),\textcolor{blue}{color->}Orange,\textcolor{blue}{width->}2,\textcolor{blue}{continue->},\textcolor{blue}{show->}0)\\
da=\textcolor{VioletRed}{newdata}(X,Y,e,\textcolor{blue}{extra->}(Regf,Resid),\textcolor{blue}{read->}(I,P,er))\\
\textcolor{VioletRed}{stat}()\\
fi=\textcolor{VioletRed}{plotyx}(P,I,\textcolor{blue}{append->},\textcolor{blue}{show->}0,\textcolor{blue}{continue->}fcont)
\\
A,Pmax,R=0.07,17,3 \textcolor{green}{!initial\,values}
\\
fi=\textcolor{VioletRed}{draw}(\textcolor{blue}{func->}(rect(f)),\textcolor{blue}{x->}I,\textcolor{blue}{xrange->}(0,1000),\textcolor{blue}{color->}Green,\textcolor{blue}{width->}2,\textcolor{blue}{append->},\textcolor{blue}{show->}0,\textcolor{blue}{continue->})\\
reg=\textcolor{VioletRed}{nonlin}(P,f,\textcolor{blue}{par->}(A,Pmax,R),\textcolor{blue}{var->},\textcolor{blue}{corr->},\textcolor{blue}{data->}da,\textcolor{blue}{trans->}rect)\\
reg\%var;\\
reg\%corr;\\
\textcolor{VioletRed}{corrmatrix}(reg\%var);\\
fi=\textcolor{VioletRed}{draw}(\textcolor{blue}{func->}(rect(f)),\textcolor{blue}{x->}I,\textcolor{blue}{xrange->}(0,1000),\textcolor{blue}{color->}Violet,\textcolor{blue}{append->},\textcolor{blue}{continue->}fcont)
\end{example}
\subsection{gamma function: \textcolor{VioletRed}{gamma}()}\index{gamma()}
\label{gamma}
Function \textcolor{VioletRed}{gamma}() produses the value of gamma funtion for a positive argument.
The function utilises gamma subroutine from
library dcdflib in Netlib.
\subsection{\textcolor{VioletRed}{logistic}(): value of the logistic function}\index{logistic()}
\label{logistic}
Returns the value of the logistic function 1/(1+\textcolor{VioletRed}{exp}(-x)). This can in principle computed by the
transformation, but the transformation will produce an error condition when the argument -x
of the exp-function is large. Because the logistic function is symmetric, these cases are
computed as 1-1/(1+\textcolor{VioletRed}{exp}(x)). Because the logistic function can be needed in the nonlinear
regression, also the derivatives are implemented.  Note, to utilse derivatives
the function needs to be in a TRANS object.
Eg when f=\textcolor{VioletRed}{logistic}(a*(x-x0)), then
the derivatives can be obtained with respect to the parameters a and x0 by
\begin{example}[logisticex]Example of logistic function\\
\label{logisticex}
tr=\textcolor{VioletRed}{trans}()\\
\textcolor{VioletRed}{der}(a,x0)\\
f=\textcolor{VioletRed}{logistic}(a*(x-x0));\\
/\\
x,x0,a=10,5,0.1\\
d[a],d[x],tr(d[x0]);
\end{example}
\begin{note}
In the previous example tr(d[x0] ahs the effect that TRANS tr is first
called, which makes that also d[a] and d[x] have been computed. Remember that
the parse tree is computed from right to left.
\end{note}
\subsection{\textcolor{VioletRed}{npv}(): net present value}\index{npv()}
\label{npv}

\textcolor{VioletRed}{npv}(]interest,income1,…,incomen,time1,…,timen[)//
Returns net present value for income sequence income1,...,incomen, occurring at times
time1,…,timen when the interest percentage is \textcolor{teal}{interest}.
\section{Functions for probality distributions}
\label{dist}
There are currently the following functions relate to probality distributions.
\begin{note}
function \textcolor{VioletRed}{density}() can be used define density or probality
function for any continuous or discrete distribution which can then be used
to generate random numbers with \textcolor{VioletRed}{random}() function.
\end{note}
\subsection{Density for normal distribution: \textcolor{VioletRed}{pdf}()}\index{pdf()}
\label{pdf}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent Output  \tabto{3cm}  1  \tabto{5cm}   REAL  \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent  the value of the density.
\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent Args  \tabto{3cm} 0-2  \tabto{5cm}   REAL  \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent  \textcolor{teal}{Arg1} is the mean (default 0), \textcolor{teal}{Arg2} is the standard deviation
(default 1). If sd is given, the mean must be given explicitly as teh first argument.
\end {changemargin}
\hline
\vspace{0.2cm}
\begin{note}
See example drawclassex for an utilization of \textcolor{VioletRed}{pdf}()
\end{note}
\subsection{Cumulative distribution function for normal and chi2: \textcolor{VioletRed}{cdf}}\index{cdf()}
\label{cdf}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent Output \tabto{3cm}  1  \tabto{5cm}   REAL  \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent  The value of the cdf.
\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent Args  \tabto{3cm}  1-3  \tabto{5cm}   REAL \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent  \textcolor{teal}{Arg1} the upper limit of the integral. When \textcolor{blue}{chi2->} is not present, then
\textcolor{teal}{Arg2}, if present is the mean of the normal distribution (defaul 0), and \textcolor{teal}{Arg3}, if present,
is the sd of the ditribution. If \textcolor{blue}{chi2->} is present, then oblicatory \textcolor{teal}{Arg2} is
ifs the number of degrees of freedom for chi2-distribution.
\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent \textcolor{blue}{chi2}  \tabto{3cm}  N |0  \tabto{5cm}    \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent \noindent chi2  \tabto{3cm}  N |0  \tabto{5cm}    \tabto{7cm}
\end {changemargin}
\hline
\vspace{0.2cm}
\subsection{\textcolor{VioletRed}{bin}(): binomial probability}\index{bin()}
\label{bin}
\textcolor{VioletRed}{bin}(\textcolor{teal}{k},\textcolor{teal}{n},\textcolor{teal}{p})//
Gives the binomial probability that there will be \textcolor{teal}{k} successes
in \textcolor{teal}{n} independent trials when in a
single trial the probability of success is \textcolor{teal}{p}.
\subsection{\textcolor{VioletRed}{negbin}():: negative binomila distribution}\index{negbin()}
\label{negbin}
\textcolor{VioletRed}{negbin}(\textcolor{teal}{k},\textcolor{teal}{myy},\textcolor{teal}{theta})//
Gives the probability that a negative binomial random variable
has value \textcolor{teal}{k} when the variable
has mean \textcolor{teal}{myy} and variance \textcolor{teal}{myy}+]theta[*]myy[**2.
\begin{note}
\textcolor{VioletRed}{negbin}(k,n*p,0)=
\textcolor{VioletRed}{bin}(k,n*p).
\end{note}
\begin{note}
Sorry for the parameter inconsistency with \textcolor{VioletRed}{rannegbin}().
\end{note}
\subsection{\textcolor{VioletRed}{density}() define}\index{density()}
\label{density}
any discrete or continues distribution for random numbers either with a function
or histogram generated with \textcolor{VioletRed}{classify}()
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent Args \tabto{3cm} 0-1 \tabto{5cm}  MATRIX  \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent  MATRIX generated with \textcolor{VioletRed}{classify}()
\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent \textcolor{blue}{func} \tabto{3cm}  N|1 \tabto{5cm}    \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent codeoption defining the density. The x-varaible is \$.
\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent \textcolor{blue}{xrange} \tabto{3cm} 0|2 \tabto{5cm}   REAL \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent  Range of x-values
\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent discrete \tabto{3cm} -1|0 \tabto{5cm}    \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent  Presence implies the the distribution is discrete
\end {changemargin}
\hline
\vspace{0.2cm}
\begin{note}
Actually the function generates a matrix having towo rows which
has values for the cumulative distribution function.
\end{note}
\begin{note}
When defining the density function, the user need not care about
the scaling constant which makes the integral to integrate up to 1.
\end{note}
\begin{example}[densityex]Example of distributions\\
\label{densityex}
ber=\textcolor{VioletRed}{density}(\textcolor{blue}{func->}(1-p+(2*p-1)*\$),\textcolor{blue}{xrange->}(0,1),discrete->); Bernoully\\
bim=\textcolor{VioletRed}{matrix}(100)\\
bim=\textcolor{VioletRed}{random}(ber)\\
\textcolor{VioletRed}{mean}(bim);\\
p*(1-p); \,\textcolor{green}{!theoretical\,variance}\\
\textcolor{VioletRed}{var}(bim);\\
pd=\textcolor{VioletRed}{density}(\textcolor{blue}{func->}\textcolor{VioletRed}{exp}(-0.5*\$*\$),\textcolor{blue}{xrange->}(-3,3)) \,\textcolor{green}{!Normal\,distribution}
\\
ra=\textcolor{VioletRed}{random}(pd);\\
f=\textcolor{VioletRed}{matrix}(1000)\\
f=\textcolor{VioletRed}{random}(pd)\\
da=\textcolor{VioletRed}{newdata}(f,\textcolor{blue}{read->}x)\\
\textcolor{VioletRed}{stat}(\textcolor{blue}{min->},\textcolor{blue}{max->})\\
cl=\textcolor{VioletRed}{classify}(\textcolor{blue}{x->}x,\textcolor{blue}{xrange->});\\
fi=\textcolor{VioletRed}{drawclass}(cl)\\
fi=\textcolor{VioletRed}{drawclass}(cl,\textcolor{blue}{area->})

\\
fi=\textcolor{VioletRed}{draw}(\textcolor{blue}{func->}\textcolor{VioletRed}{pdf}(x),\textcolor{blue}{x->}x,\textcolor{blue}{xrange->},\textcolor{blue}{append->})\\
f=\textcolor{VioletRed}{matrix}(1000)\\
f=\textcolor{VioletRed}{rann}()\\
da=\textcolor{VioletRed}{newdata}(f,\textcolor{blue}{read->}x)\\
\textcolor{VioletRed}{stat}(\textcolor{blue}{min->},\textcolor{blue}{max->})\\
cl=\textcolor{VioletRed}{classify}(\textcolor{blue}{x->}x,\textcolor{blue}{xrange->})\\
fi=\textcolor{VioletRed}{drawclass}(cl,\textcolor{blue}{histogram->},\textcolor{blue}{classes->}20)\\
den=\textcolor{VioletRed}{density}(cl);\\
fi=\textcolor{VioletRed}{drawline}(den)
\end{example}
\section{Random number generators}
\label{randomgen}
Random number generators are taken from Ranlib library of Netlib.
They can produce single REAL variables or random MATRIX objects.
Random matrices are produced by defining first a matrix with \textcolor{VioletRed}{matrix}()
funtion and putting that as the output.
\subsection{Generate an uniform random number}
\label{ran}
Uniform random numbers between 0 and 1 are generating usig Netlib function ranf.
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent Output \tabto{3cm}  1 \tabto{5cm}   REAL |MATRIX   \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent  The generated REAL value or MATRIX.
Random matrix cab generated by defining first the matrix with \textcolor{VioletRed}{matrix}().
\end {changemargin}
\hline
\vspace{0.2cm}
\begin{example}[ranex]\\
\label{ranex}
\textcolor{VioletRed}{ran}();\\
\textcolor{VioletRed}{ran}();\\
cpu0=cpu()\\
A=\textcolor{VioletRed}{matrix}(10000,5)\\
A=\textcolor{VioletRed}{ran}()\\
\textcolor{VioletRed}{mean}(A);\\
\textcolor{VioletRed}{mean}(A,\textcolor{blue}{any->}) \textcolor{green}{!mean\,over\,all\,elements}\\
\textcolor{VioletRed}{mean}(A(All,2));\\
\textcolor{VioletRed}{sd}(A);\\
\textcolor{VioletRed}{sd}(A,\textcolor{blue}{any->});\\
\textcolor{VioletRed}{min}(A);\\
\textcolor{VioletRed}{min}(A,\textcolor{blue}{any->});\\
\textcolor{VioletRed}{max}(A);\\
cpu()-cpu0;

\end{example}

\subsection{\textcolor{VioletRed}{rann}()}\index{rann()}
\label{rann}
Computes normally distributed pseudo random numbers into a REAL variable or
into MATRIX.
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent Output \tabto{3cm} 1 \tabto{5cm}  REAL|MATRIX \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent The matrix to be generated bus be defined earlier with \textcolor{VioletRed}{matrix}().cm} er
\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent Args \tabto{3cm} 0-2 \tabto{5cm}  num \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent  rannn() produces N(0,1) variables, \textcolor{VioletRed}{rann}(mean) will produce
N(mean,1) variables and \textcolor{VioletRed}{rann}(mean,sd) procuses N(mean,sd) variables.
\end {changemargin}
\hline
\vspace{0.2cm}
\begin{example}[rannex]Random normal variates, illustrating also find\\
\label{rannex}
rx=\textcolor{VioletRed}{rann}() \,\textcolor{green}{!Output\,is\,REAL}\\
rm=\textcolor{VioletRed}{matrix}(100)\\
\textcolor{VioletRed}{print}(\textcolor{VioletRed}{mean}(rm),\textcolor{VioletRed}{sd}(rm),\textcolor{VioletRed}{min}(rm),\textcolor{VioletRed}{max}(rm))\\
large=\textcolor{VioletRed}{find}(rm,\textcolor{blue}{filter->}(\$.ge.2),any)\\
\textcolor{VioletRed}{print}(100*nrows(large)/\textcolor{VioletRed}{nrows}(rm))\\
cpu0=cpu()\\
rm2=\textcolor{VioletRed}{matrix}(1000000)\\
rm2=\textcolor{VioletRed}{rann}(10,2) \,\textcolor{green}{!there\,cannot\,be\,arithmetix\,opreations\,in\,the\,right\,side}\\
cpu()-cpu0;\\
\textcolor{VioletRed}{mean}(rm2),\textcolor{VioletRed}{sd}(rm2),\textcolor{VioletRed}{min}(rm2),\textcolor{VioletRed}{max}(rm2);\\
large=\textcolor{VioletRed}{find}(rm,\textcolor{blue}{filter->}(\$.ge.14),\textcolor{blue}{any->})\\
\textcolor{VioletRed}{print}(100*nrows(large)/\textcolor{VioletRed}{nrows}(rm))\\
!
\end{example}
\begin{note}
When generating a matrix with random numbers, there cannot be
arithmetic operations on the right side.That means that code:\newline
rm=\textcolor{VioletRed}{matrix}(100)\newline
rm=2*rann()\newline
would produce a REAL value rm.
\end{note}

\subsection{\textcolor{VioletRed}{ranpoi}(): random Poisson variables}\index{ranpoi()}
\label{ranpoi}
\textcolor{VioletRed}{ranpoi}(\textcolor{teal}{myy}//
returns a random Poisson variable with expected value and variance \textcolor{teal}{myy}
\subsection{Generate random binomial values}
\label{ranbin}

Binomial random numbers between 0 and n are generating usig Netlib
ignbin(n,p).Random matrix can generated by defining first
the matrix with \textcolor{VioletRed}{matrix}().
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent Output \tabto{3cm}  1 \tabto{5cm}   REAL |MATRIX   \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent  The generated REAL value or MATRIX with
number of successes. (J does not have explicit integer type object).
\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent Args  \tabto{3cm} 2 \tabto{5cm}  REAL \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent  \textcolor{teal}{Arg1} is the number of trials (n) and \textcolor{teal}{Arg2} is the probability
of succes in one trial.
!
\end {changemargin}
\hline
\vspace{0.2cm}
\begin{example}[ranbinex]x\\
\label{ranbinex}
\textcolor{VioletRed}{ranbin}(10,0.1);
\\
\textcolor{VioletRed}{ranbin}(10,0.1);\\
!\\
A=\textcolor{VioletRed}{matrix}(1000,2)\\
A(All,1)=\textcolor{VioletRed}{ranbin}(20,0.2)\\
A(All,2)=\textcolor{VioletRed}{ranbin}(20,0.2)\\
da=\textcolor{VioletRed}{newdata}(A,\textcolor{blue}{read->}(s1,s2))\\
\textcolor{VioletRed}{stat}()\\
cl=\textcolor{VioletRed}{classify}(1,\textcolor{blue}{x->}s1)\\
fi=\textcolor{VioletRed}{drawclass}(cl,\textcolor{blue}{histogram->},\textcolor{blue}{color->}Blue,\textcolor{blue}{continue->}fcont)\\
cl=\textcolor{VioletRed}{classify}(1,\textcolor{blue}{x->}s2)\\
fi=\textcolor{VioletRed}{drawclass}(cl,\textcolor{blue}{histogram->},\textcolor{blue}{color->}Red,\textcolor{blue}{append->},\textcolor{blue}{continue->}fcont)
\end{example}

\subsection{Generate negative binomial variates: \textcolor{VioletRed}{rannegbin}()}\index{rannegbin()}
\label{rannegbin}
The  function  returns  random  number  distributed  according to the
negative binomila distribution.
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent Output \tabto{3cm} 1 \tabto{5cm}  REAL | MATRIX  \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent  the number of successes in
independent Bernoul trials before r’th failure when
p is the probability of success. \textcolor{VioletRed}{ranbin}(r,1)returns 1.7e37 and
\textcolor{VioletRed}{ranbin}(r,0)returns 0.
\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent \textcolor{green}{!Args\,\tabto{3cm}\,\,\tabto{5cm}\,\,REAL\,\tabto{7cm}\,}
\begin{changemargin}{3cm}{0cm}
\noindent  r=\textcolor{teal}{Arg1} and p=\textcolor{teal}{Arg1}
\end {changemargin}
\hline
\vspace{0.2cm}

\begin{note}
there are different ways to define the negative binomial distribution. In this definition
a Poisson random variable with mean \$\lamda\$ is obtained by letting r go
to infinity and defining p= \$\lamda\$/( \$\lamda\$+r)
The mean E(x) of this definition is p*r/(1-p) and the variance is V=p*r/(1-p)2. Thus given
E(x) and V, r and p can be obtained as follows: p=1- E(x) /V and r= E(x)**2/(V- E(x)) . This is useful when
simulating ‘overdispersed Poisson’ variables. Sorry for the (temporary) inconsistency of parameters with
function \textcolor{VioletRed}{negbin}().
\end{note}
\begin{note}
can also have a noninteger values. This is not in accordance with the above
interpretation of the distribution, but it is compatible with interpreting negative binomial
distribution as a compound gamma-Poisson distribution and it is useful when simulating
overdispersed Poisson distributions.
\end{note}
\subsection{Random selection of elemets}
\label{select}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent Output \tabto{3cm} 1 \tabto{5cm}  MATRIX  \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent column vector with n elements indicating random
selection of k
elements out of n elements. The selection is with without replacement,
thus elements of the output are 1 or 0..
\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent Args \tabto{3cm} 2 \tabto{5cm}  REAL \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent  k=\textcolor{teal}{Arg1} and n=\textcolor{teal}{Arg2}.
\end {changemargin}
\hline
\vspace{0.2cm}
\begin{example}[selectex]Random selection\\
\label{selectex}
S=\textcolor{VioletRed}{select}(500,10000)\\
\textcolor{VioletRed}{mean}(S),\textcolor{VioletRed}{sum}(S),500/10000;
\end{example}
\subsection{\textcolor{VioletRed}{random}(): generate random scalrs or matrices defined with}\index{random()density()}
\label{random}
usage \textcolor{VioletRed}{random}(\textcolor{teal}{dist}) where \textcolor{teal}{dist} is the density defined in \textcolor{VioletRed}{density}().
See \textcolor{VioletRed}{density}() for examples.
\section{Functions for interpolation}
\label{inter}
The following functions can be used for interpolation
\subsection{interpolate}
\label{interpolate}
Usage://
\textcolor{VioletRed}{interpolate}(x0,x1[,x2],y0,y1[,y2],x]//
If arguments x2 and y2 are given then computes the value of the quadratic function at value
x going through the three points, otherwise computes the value of the linear function at value
x going through the two points.
\begin{note}
The argument x need not be within the interval of given x values (thus the function also
extrapolates).
\end{note}
\subsection{\textcolor{VioletRed}{plane}() interpolation from a plane}\index{plane()}
\label{plane}
Usage://
\textcolor{VioletRed}{plane}(x1,x2,x3,y1,y2,y3,z1,z2,z3,x,y]//
The function computes the equation of plane going through the three points (x1,y1,z1), etc
and computes the value of the z-coordinate in point (x,y). The three points defining the plane
cannot be on single line.
\subsection{\textcolor{VioletRed}{bilin}(): bilinear interpolation}\index{bilin()}
\label{bilin}
Usage://
\textcolor{VioletRed}{bilin}(x1,x2,y1,y2,z1,z2,z3,z4,x,y]//
z1 is the value of function at point (x1,y1), z2 is the value at point (x1,y2), z3 is the value at
(x2,y1) and z4 is the value at (x2,y2): the function is using bilinear interpolation to compute
the value of the z-coordinate in point (x,y). The point (x,y) needs not be within the square
defined by the corner points, but it is good if it is. See Press et al. ? (or Google) for the principle
of bilinear interpolation
\section{List functions}
\label{lists}
The following list functions are available
\subsection{Object lists}
\label{listo}
An object list is a list of named \textbf{J} object. See Shortcuts for implicit object
lists and List functions for more details. Object lists can be used also as
pointers to objects, see e.g. the selector option of the simulate() function.
\subsection{\textcolor{VioletRed}{list}() generates a LIST object}\index{list()}
\label{list}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent Output \tabto{3cm}  1 \tabto{5cm}   LIST  \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent The generated LIST object.
\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent Args \tabto{3cm}  0-  \tabto{5cm}     \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent  named objects. If an argument is LIST it is ex+panded
\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent \textcolor{blue}{mask} \tabto{3cm}  N|1-  \tabto{5cm}  REAl \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent  Which object are picked from the list of arguments.\ta
value 0 indicates that
he object is dropped, positive value indicates how many variables are taken,
negative value how many objects are dropped (thus 0 is equivalent to -1). mask-
option is useful for creating sublists of long lists.
\end {changemargin}
\hline
\vspace{0.2cm}
\begin{note}
The same object may appear several times in the list. (see \textcolor{VioletRed}{merge}())ge
\end{note}
\begin{note}
There may be zero arguments, which result in an empty list
which can be updated later.
\end{note}
\begin{note}
The index of object in a LIST can be obtained using \textcolor{VioletRed}{index}().ex
\end{note}
\\
li=\textcolor{VioletRed}{list}(x1...x3);
\\
\textcolor{VioletRed}{index}(x2,li);
\\
Continue=1
\\
\textcolor{VioletRed}{index}(x4,li); \,\textcolor{green}{!\,error}
\\
Continue=0
\\


\begin{example}[list2ex]x\\
\label{list2ex}
all=\textcolor{VioletRed}{list}(); \,\textcolor{green}{!\,empty\,list}\\
sub=\textcolor{VioletRed}{list}();\\
nper=3\\
\textcolor{Red}{;do}(i,1,nper)\\
period\#"i"=\textcolor{VioletRed}{list}(ba\#"i",vol\#"i",age\#"i",harv\#"i")\\
sub\#"i"=\textcolor{VioletRed}{list}(@period\#"i",\textcolor{blue}{mask->}(-2,1,-1))\\
all=\textcolor{VioletRed}{list}(@all,@period\#"i") \textcolor{green}{!note\,that\,all\,is\,on\,both\,sides}\\
sub=\textcolor{VioletRed}{list}(@sub,@sub\#"i")\\
;end do
\end{example}
\subsection{\textcolor{VioletRed}{merge}()}\index{merge()}
\label{merge}
\textcolor{VioletRed}{merge}() will produce of list consisting of separate objects
in argument lists and argument objects.
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent Output \tabto{3cm} 1 \tabto{5cm}  LIST \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent A list which is produced by first putting all elements of
argument lists and non-list arguments into a vector, and then duplicate objects are dropped.
\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent Args \tabto{3cm} 2- \tabto{5cm}  LIST|OBJ \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent  LIST and separate non-list objects.
\end {changemargin}
\hline
\vspace{0.2cm}
\begin{example}[mergex]Merging list\\
\label{mergex}
x1...x3=1,2,3\\
mat=\textcolor{VioletRed}{matrix}(3,\textcolor{blue}{values->}(4,5,6))\\
lis0=\textcolor{VioletRed}{list}(x2,x1)\\
lis2=\textcolor{VioletRed}{merge}(x1,mat,lis0)\\
\textcolor{VioletRed}{print}(lis2)
\color{Green}
\begin{verbatim}
<print(lis2)
lis2 is list with            3  elements:
x1 mat x2
\end{verbatim}
\color{Black}
\end{example}
\subsection{Difference of LIST objects}
\label{difference}
\textcolor{VioletRed}{difference}() removes elements from a LIST
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent Output \tabto{3cm}  1 \tabto{5cm}  LIST  \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent  the generated LIST.
\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent Args \tabto{3cm} 2 \tabto{5cm}  LIST|OBJ  \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent  The first argument gives the LIST from which the elements of of the
are removed  If second argument is LIST then all of its eleemts are remove, other wise
it is assumed that the second argument is an object which is remode from the lisrt.
\end {changemargin}
\hline
\vspace{0.2cm}
\begin{example}[diffex]fex\\
\label{diffex}
lis=\textcolor{VioletRed}{list}(x1...x3,z3..z5);\\
lis2=\textcolor{VioletRed}{list}(x1,z5);\\
liso=\textcolor{VioletRed}{difference}(lis,lis2);\\
liso2=\textcolor{VioletRed}{difference}(liso,z3);\\
Continue=1\\
lisoer=\textcolor{VioletRed}{difference}(lis,z6); \textcolor{green}{!\,error\,occurs}\\
liser=\textcolor{VioletRed}{difference}(Lis,x3); \,\textcolor{green}{!error\,occurs}\\
Continue=0
\end{example}
\subsection{\textcolor{VioletRed}{index}(): index of a variable in a data object}\index{index()}
\label{index}
To be documented later
\subsection{\textcolor{VioletRed}{index}(): index of a variable in a data object}\index{index()}
\label{index}
To be documented later
\subsection{\textcolor{VioletRed}{len}() lengths of different lists or vectors}\index{len()}
\label{len}
\textcolor{VioletRed}{len}(\textcolor{teal}{arg}) gives the following lenghts for different argument types
\begin{itemize)
\item[\textbf{J}\.] \textcolor{teal}{arg} is MATRIX => len=the size of the matrix, i.e.
\textcolor{VioletRed}{nrows}(\textcolor{teal}{arg})*ncols(\textcolor{teal}{arg})

\item[\textbf{J}\.] \textcolor{teal}{arg} is TEXT => len=the number of chracter in TEXT object

\item[\textbf{J}\.] \textcolor{teal}{arg} is LIST => len=the number of elements in LIST
\item[\textbf{J}\.] \textcolor{teal}{arg} is ILIST => len=the number of elements in ILIST
\end{itemize}
If \textcolor{teal}{arg} does not have a legal type for \textcolor{VioletRed}{len}(), then \textcolor{VioletRed}{len}(\textcolor{teal}{arg})=-1 if \textcolor{VioletRed}{len}() has
option \textcolor{blue}{any->}, otherwise an error is produced.
\subsection{List of integers}
\label{ilist}
Generates a list of integers which can be used as indexes. This function
is used implicitly with {}.
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent Output \tabto{3cm}  1 \tabto{5cm}   ILIST  \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent The generated ILIST.
\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent Args \tabto{3cm}  0-  \tabto{5cm}  REAL  \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent  Values to be put into ILIST, or the dimesion
of the ILIST when values are given in \textcolor{blue}{values->},  or variables whose indeces
in in the data are put into the ILIST.
\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent \textcolor{blue}{data} \tabto{3cm} N|1 \tabto{5cm}   DATA \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent  The DATA object from whose variable indeces are obtained.
\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent \textcolor{blue}{extra}  \tabto{3cm}  1 \tabto{5cm}  REAL  \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent  Extra space reserved for later updates of the ILIST.
\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent \textcolor{blue}{values}  \tabto{3cm} N|1- \tabto{5cm}   REAL \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent  Values to be put into ILIST when dimesnion is determined as the
only argument
\end {changemargin}
\hline
\vspace{0.2cm}
\begin{note}
ILIST is a new object whose all utilization possiblities are not yet explored.
It will be used e.g. when developing factory optimization.
\end{note}
\begin{note}
eote
Using \textcolor{VioletRed}{ilist}() by giving the dimension as argument and values with \textcolor{blue}{values->} option
imitates the definition of a matrix (column vector). The structure of ILIST object
is the same as LIST object which can be used in matrix computations.
\end{note}
\begin{example}[ilistex]ILIST examples\\
\label{ilistex}
{1,4,5};\\
{4...1};\\
A=\textcolor{VioletRed}{matrix}(4,4)\\
A({1,5},{3}=
\end{example}
\subsection{\textcolor{VioletRed}{putlist}()}\index{putlist()}
\label{putlist}
Usage://
\textcolor{VioletRed}{putlist}(LIST,OBJ)//
put OBJ into LIST
\section{Creating two types of text objects}
\label{texts}
The are now two object types for text.
\subsection{\textcolor{VioletRed}{text}() creates the old TEXT object}\index{text()}
\label{text}
Text objects are created as a side product by many \textbf{J} functions. Text objects can be created
directly by the \textcolor{VioletRed}{text}() function which works in a nonstandard way. The syntax is:
output=\textcolor{VioletRed}{text}()//
…
//

The input paragraph ends exceptionally with '//' and not with '/'. The lines within the input
paragraph of text are put literally into the text object (i.e. even if there would be input
programming functions or structures included)
\subsection{\textcolor{VioletRed}{txt}() generates the new TXT object.}\index{txt()}
\label{txt}
Works as \textcolor{VioletRed}{text}(), to be documented later. The new TXT object is used
to implement \textcolor{Red}{;incl} and Gnuplot -figures.
\section{File handling}
\label{file}
The following function can handle files.
\subsection{_o exist\_o(): does an object exist}
\label{exist}
looks whether an object with the name given in
the character constant  argument exists.
\begin{note}
In the prvious versions of \textbf{J} same function was used for files and objects.
\end{note}
\subsection{Deleting objects: delete\_o()}
\label{delete}
When an object with a given name is created, the name cannot be removed. With
delete\_0() function one can free all memory allocated for data structures needed
by general objects:
delete\_o(obj1,…,objn)
After deleting an object, the name refers to a real variable (which is
initialized by the delete\_o() function into zero).
\begin{note}
Other objects except matrices can equivalently be deleted by giving
command
obj1,…,objn = 0
This is because the output objects of any functions are first deleted before
defining them anew. Usually an object is automatically deleted if the object
name is as an output object for other functions.
\end{note}
\begin{note}
One can see how much memory each object is using \textcolor{VioletRed}{print}(Names).mes
\end{note}
\begin{note}
Deleting a compound object deletes also such
subobjects which have no meaning when the main object is deleted. But e.g. if a
data object is deleted then the as-sociated transformation object is not
deleted as the transformation can be used independently.
\end{note}
\begin{note}
Files can be deleted with delete\_f(file). See IO-functions for
details.
\end{note}
\begin{note}
If the user has defined own new compound objects in the open source
\textbf{J} software she/he needs to define the associated delete function.
\end{note}
\subsection{\textcolor{VioletRed}{close}() closes a file}\index{close()}
\label{close}
\textcolor{VioletRed}{close}(file) closes an open file where file is either a character constant
or character variable associated with a file.
\begin{note}
No open(9 function is needed. An file is opened when it is first time in \textcolor{VioletRed}{write}().te
if the file exists, it is asked whether the old file is dleted.
\end{note}
\subsection{\textcolor{VioletRed}{showdir}() shows the current directory}\index{showdir()}
\label{showdir}
\begin{note}
showdir is defined in the system dependent file jsysdep\_gfortran.f90.
Using other compliers it may be neccessary to change the definition
\end{note}
\subsection{\textcolor{VioletRed}{setdir}() sets the current directory}\index{setdir()}
\label{setdir}
\begin{note}
setdir is defined in the system dependent file jsysdep\_gfortran.f90.
Using other complilers it may be neccessary to change the definition
\end{note}
\subsection{\textcolor{VioletRed}{thisfile}() returns the name of the current include file}\index{thisfile()}
\label{thisfile}
The name of the current include file is returned as a character variable by:
out=\textcolor{VioletRed}{thisfile}()
This is useful when defining shortcuts for commands that include sections from an include file.
Using this function the shortcuts work even if the name of the include file is changed. See file
jexamples.inc for an application
\subsection{\textcolor{VioletRed}{filestat}() gives information of a file}\index{filestat()}
\label{filestat}
Function \textcolor{VioletRed}{filestat}(filename) prints the size of the
file in bytes (if available) and the time the file was last accessed
\section{Io-functions}
\label{io}
Theree are following io functions
\subsection{\textcolor{VioletRed}{read}() read from a file}\index{read()}
\label{read}
\textcolor{VioletRed}{read}(file,format[,obj1,…,objn][,\textcolor{blue}{eof->}var] [,\textcolor{blue}{wait->}])//
Reads real variables or matrices from a file. If there are no objects
to be read, then a record is
by-passed.//
Arguments:
file the file name as a character variable or a character constant//
format//
b' unformatted (binary) data //
'bn' unformatted, but for each record there is integer for the size of the record. Does
not work when reading matrices.
'bis' binary data consisting of bytes, each value is converted to real value (the only
numeric data type in J). This works only when reading matrices.//
'(….)' a Fortran format. Does not work when reading matrices.
\$ the * format of Fortran//
obj1,…,objn
\textbf{J} objects//
Options://
eof Defines the variable which indicates the end of file condition of the file. If the end
of the file is not reached the variable gets the value 0, and when the end of file is
reached then the variable gets value 1 and the file is closed without extra notice.

When \textcolor{blue}{eof->} option is not present and the file ends then an error
condition occurs and the file is closed.//
wait \textbf{J} is waiting until the file can be opened. Useful in client-server applications. See
chapter \textbf{J} as a server.
\begin{note}
Use \textcolor{VioletRed}{ask}() or \textcolor{VioletRed}{askc}() to read values from the terminal when reading lines from an
include file.
\end{note}
\begin{note}
When reading matrices, their shapes need to
be defined earlier with \textcolor{VioletRed}{matrix}()
hfunction.
\end{note}
\subsection{\textcolor{VioletRed}{write}()}\index{write()}
\label{write}
\textcolor{VioletRed}{write}(file,format,val1,…,valn[,\textcolor{blue}{tab->}][,\textcolor{blue}{rows->}])\textcolor{green}{!\,case[1/6]}
Writes real values to a file or to the console. If val1 is a matrix then this matrix (or usually
vector) is written or at most as many values as given in the \textcolor{blue}{values->} option.
Arguments:
file variable \$ (indicating the console), or the name of the file as a character variable
or a character constant, or variable \$Buffer
format
\$ indicates the '*' format of Fortran, works only for numeric values.
A character expression, with the following possibilities:
A format starting with 'b' will indicate binary file. Now 'b' indicates ordinary
unformatted write, later there will be other binary formats
A Fortran format statement, e.g. ($\sim$the\,values\,were\,$\sim$,4f6.0), with this
format pure text can be written by having no object to write (e.g.
\textcolor{VioletRed}{write}('out.txt','($\sim$kukuu$\sim$)')).
For these formats, other arguments are supposed to be real variables or numeric
expressions or there is a matrix argument. If they are not, then just the real value
which is anyhow associated with each \textbf{J} object is printed (usually it will be zero).
If the val1 argument is a matrix, then all values are printed.
val1,…,valn
real values
Options:
tab if format is a Fortran format then, \textcolor{blue}{tab->} option indicates that sequences of
spaces are replaced by tab character so that written text can be easily converted
to Ms Word tables. If there are no decimals after the decimal point also the
decimal point is dropped.
rows If val1 is a matrix or a vector and \textcolor{blue}{rows->} has one argument then at most as
many values are written as given in this option, if there are two arguments then
the option gives the range of written rows in the form \textcolor{blue}{rows->}(row1,-row2). If the
upper limit is greater than the number of rows, no error is produced, all available
rows are just written.
\textcolor{VioletRed}{write}(file,'t',t1,val1,t2,val2,…,tn,valn[,\textcolor{blue}{tab->}]) \textcolor{green}{!\,case[2/6]}
Tabulation format. positive tab position values indicate that the value is written starting from
that position, negative tab positions indicate that the value is written up to that position. The
values can be either numeric expressions or character variables or character constants. Tab
positions can be in any order.
Arguments:
file variable \$ (indicating the console), or the name of the file as a character variable
or a character constant, or variable \$Buffer
't' tabulation format
t1,val1,t2,val2,…,tn,valn
KUVAUS
Options:
tab option indicates that sequences of spaces are replaced by tab character so that
writ-ten text can be easily converted to Ms Word tables.

\subsection{\textcolor{VioletRed}{print}() prints objects}\index{print()}
\label{print}
\textcolor{VioletRed}{print}(arg1,…,argn[,\textcolor{blue}{maxlines->}][,\textcolor{blue}{data->}][,\textcolor{blue}{row->}]
[,\textcolor{blue}{file->}][,\textcolor{blue}{func->}][,\textcolor{blue}{debug->}])//
Print values of variables or information about objects.//
Arguments:
arg1,…,argn
arguments can be any \textbf{J} objects or values of arithmetic or logical expressions
Options:
maxlines the maximum number of lines printed for matrices, default 100.
data data sets. If \textcolor{blue}{data->} option is given then arguments must be ordinary real
variables obtained from data.
row if a text object is printed, then the first value given in the \textcolor{blue}{row->} option gives the
first line to be printed. If a range of lines is printed, then the second argument
must be the negative of the last line to be printed (e.q. \textcolor{blue}{row->}(10,-15)).Note
that \textcolor{VioletRed}{nrows}() function can be used to get the number of rows.
file the file name as a character variable or a character constant. Redirects the output
of the \textcolor{VioletRed}{print}() function to given file. After printing to the file, the file remains
open and must be explicitly closed (\textcolor{VioletRed}{close}(‘file’)) if it should be opened in
a different application.
form when a matrix is printed, the format for a row can be given as a Fortran format,
e.g. form ‘(15f6.2)’ may be useful when printing a correlation matrix.
debug the associated real variable part is first printed, and thereafter the tow associated
two integer vectors, the real vector and the double precision vector
func all functions available are printed
\begin{note}
For simple objects, all the object content is printed, for complicates objects only
summary information is printed. \textcolor{VioletRed}{print}(Names) will list the names, types and sizes of all
named \textbf{J} objects. The printing format is dependent on the object type.
\end{note}
\begin{note}
\textcolor{VioletRed}{print}() function can be executed for the output of a \textbf{J} command
by writing ';' or ';;' at the end of the line. The excution of implied \textcolor{VioletRed}{print}()
is dependent on the value of \textcolor{teal}{Printoutput}. If \textcolor{teal}{printoutput} =0,
then the output is not printed, If \textcolor{teal}{printoutput} =1, then ';' is
causing printing, if \textcolor{teal}{Printoutput} =2 then only ';;'-outputs are
printed, and if \textcolor{teal}{Printoutput} =3, the bot ';' and ';;' outputs are printed.
\end{note}


\subsection{\textcolor{VioletRed}{ask}() asks a value for REAL}\index{ask()}
\label{ask}
\textcolor{VioletRed}{ask}([var][,\textcolor{blue}{default->}][,\textcolor{blue}{q->}][,\textcolor{blue}{exit->}])//
Ask values for a variable while reading commands from an include file.//
Argument://
var 0 or one real variable (need not exist before)
Options:
default default values for the asked variables
q text used in asking
exit if the value given in this option is read, then the control returns to command level
similarly as if an error would occur. If there is no value given in this option, then
the exit takes place if the text given as answer is not a number.
\begin{note}
If there are no arguments, then the value is asked for the output variable, otherwise for
the argument. The value is interpreted, so it can be defined using transformations.
Response with carriage return indicates that the variables get the default values. If there is no
\textcolor{blue}{default->} option, then the previous value of the variable is maintained (which is also printed
as the \textcolor{blue}{default->} value in asking)
\end{note}

\begin{example}[askex]Examples for \textcolor{VioletRed}{ask}()\\
\label{askex}
a=\textcolor{VioletRed}{ask}(\textcolor{blue}{default->}8)\\
\textcolor{VioletRed}{ask}(a,\textcolor{blue}{default->}8)\\
\textcolor{VioletRed}{print}(\textcolor{VioletRed}{ask}()+\textcolor{VioletRed}{ask}()) \textcolor{green}{!\,ask\,without\,argument\,is\,a\,numeric\,function}\\
\textcolor{VioletRed}{ask}(v,\textcolor{blue}{q->}'Give v>')
\end{example}
\subsection{\textcolor{VioletRed}{askc}() asks a value for a character variable}\index{askc()}
\label{askc}
Usage ://
\textcolor{VioletRed}{askc}(chvar1[,\textcolor{blue}{default->}][,\textcolor{blue}{q->}][,\textcolor{blue}{exit->}])
Asks values for character variables when reading commands from an include file.

\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent Args \tabto{3cm} 0-4 \tabto{5cm}  REAL | ILIST \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent row and column range as explained below.

\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent Args  \tabto{3cm}  0|1  \tabto{5cm}  CHAR  \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent  character variable (need not exist before)

\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent \textcolor{blue}{default} \tabto{3cm} 0|1 \tabto{5cm}  CHAR  \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent  default character stings
\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent \textcolor{blue}{q}  \tabto{3cm}  0|1  \tabto{5cm}  CHAR  \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent text used in asking
\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent \textcolor{blue}{exit} \tabto{3cm}  -1|0 \tabto{5cm}    \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent  if the character constant or variable given in this option is read, then the control
return to command level similarly as if an error would occur.
\end {changemargin}
\hline
\vspace{0.2cm}
\begin{note}
Note
Response with carriage return indicates that the variable gets the default value. If there is no
\textcolor{blue}{default->} option, then the variable will be unchanged (i.e. it may remain also as another
object type than character variable).
\end{note}
\begin{note}
If there are no arguments, then the value is asked for the output variable, otherwise for
the arguments.
\end{note}
\subsection{\textcolor{VioletRed}{printresult}() and \textcolor{VioletRed}{printresult2}() e}\index{printresult()printresult2()}
\label{printresult}
The \textbf{J} interpreter translates ';'  at the end of the
line to a call to \textcolor{VioletRed}{printresult}() function and ';;' to a call to \textcolor{VioletRed}{printresult2}()
The output of a function is printed by writing ';' or ';;' at the end of the line. The excution of implied \textcolor{VioletRed}{print}()
is dependent on the value of \textcolor{teal}{Printoutput}. If \textcolor{teal}{printoutput} =0,
then the output is not printed, If \textcolor{teal}{printoutput} =1, then ';' is
causing printing, if \textcolor{teal}{Printoutput} =2 then only ';;'-outputs are
printed, and if \textcolor{teal}{Printoutput} =3, the bot ';' and ';;' outputs are printed.
\begin{note}
\textcolor{VioletRed}{printresult}() and \textcolor{VioletRed}{printresult2}() are  simple functions
which just test the value of
\textcolor{teal}{Printoutput} and then call the  printing subroutine, if needed.
\end{note}
\section{Matrix functions}
\label{matrixs}
\textbf{J} contains now the following matrix functions.
\subsection{Create a matrix: \textcolor{VioletRed}{matrix}()}\index{matrix()}
\label{matrix}
Function \textcolor{VioletRed}{matrix}() creates a matrix and puts REAL values to the elements. Element values
can be read from the input paragraph, file, or the values can be generated
using \textcolor{blue}{values->} option, or sequential values can be generated
using \textcolor{blue}{do->} option. Function \textcolor{VioletRed}{matrix}() can generate a diagonal and block diagonal matrix.
A matrix can be generated from submatrices by using matrices as arguments
of the  \textcolor{blue}{values->} option. It should be noted that matrices are stored in row order.
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent Output \tabto{3cm}  1 \tabto{5cm}   MATRIX | REAL \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent  If a 1x1 matrix is defined, the output will be REAL.
The output can be a temporary matrix without name, if \textcolor{VioletRed}{matrix}() is an argument
of an arithmetic function  or matrix function. If no element values are
given in \textcolor{blue}{values->} or obtained from \textcolor{blue}{in->} input, all elemets get value zero.
\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent Args \tabto{3cm} 0-2 \tabto{5cm}  REAL \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent  The dimension of the matrix. The first argument gives the number of rows,
the second argument, if present, the number of columns.  If the matrix is generated from submatrices given in \textcolor{blue}{values->}, then the dimensions
refer to the submatrix rows and submatrix columns. If there are no arguments, then the
it should be possible to infer the dimensions from \textcolor{blue}{values->} option. If the
first argument is \textcolor{teal}{Inf}, the the number of rows is determined by the number
number of lines in source determined by \textcolor{blue}{in->}.
\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent \textcolor{blue}{in} \tabto{3cm} N|0|1 \tabto{5cm}  CHAR \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent  The input for values. \textcolor{blue}{in->} means that values are read in from
the following input paragraps, \textcolor{blue}{in->}\textcolor{teal}{file} means that the values are read from file.
in both cases a record must contain one row for the matrix.
If there is reading error and values are read from the terminal, \textbf{J} gives
possibility to continue with better luck, otherwise an error occurs.
\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent \textcolor{blue}{values} \tabto{3cm} N|1- \tabto{5cm}   REAL  \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent values or MATRIX objects put to the matrix. The argumenst of
\textcolor{blue}{values->} option go in the regular way
through the interpreter, so the values can be obtained by computations. If only one REAL value is
given then all diagonal elements are put equal to the value (ohers will be zero),
if \textcolor{blue}{diag->} option is present, otherwise all elements are put equal to this value. If matrix dimensions
are given, and there are fewer values than is the size the matrix, matrix is
filled row by row using all values given in
\textcolor{blue}{values->}. If there are more values as is the size, an error occurs unless there is
\textcolor{blue}{any->} option present.
Thus \textcolor{VioletRed}{matrix}(N,N,\textcolor{blue}{values->}1) generates the identity matrix.
If value-> refers to one MATRIX,and \textcolor{blue}{diag->} is present then a block diagonal
matrix is generated. Without \textcolor{blue}{diag->}, a partitioned matrix is generated having all
submatrices equal
\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent \textcolor{blue}{do}  \tabto{3cm} N|0-3 \tabto{5cm}  REAL   \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent  A matrix of number sequences is generated, as followsws: \newline
\textcolor{blue}{do->} Values 1,2,...,\textcolor{teal}{arg1} x \textcolor{teal}{arg2} are put into the matrix in the row order. \newline
\textcolor{blue}{do->}5 Values 5,6,...,\textcolor{teal}{arg1} x \textcolor{teal}{arg2}+4 are put into the matrix \newline
\textcolor{blue}{do->}
\end {changemargin}
\hline
\vspace{0.2cm}
\begin{example}[matrixex]Example of generating matrices\\
\label{matrixex}
A=\textcolor{VioletRed}{matrix}(3,

\end{example}

\subsection{\textcolor{VioletRed}{nrows}() can be used as:}\index{nrows()}
\label{nrows}
\begin{itemize}
\item[\textbf{J}\.] \textcolor{VioletRed}{nrows}(MATRIX)
\item[\textbf{J}\.] \textcolor{VioletRed}{nrows}(TEXT)
\item[\textbf{J}\.] \textcolor{VioletRed}{nrows}(BITMATRIX)
\end{itemize}
\begin{note}
If the argument has another object type, and error occurs
\end{note}
\subsection{\textcolor{VioletRed}{ncols}() can be used as:}\index{ncols()}
\label{ncols}
\begin{itemize}
\item[\textbf{J}\.] \textcolor{VioletRed}{nrows}(MATRIX)
\item[\textbf{J}\.] \textcolor{VioletRed}{nrows}(BITMATRIX)
\end{itemize}
\begin{note}
If the argument has another object type, and error occurs
\end{note}
\subsection{\textcolor{VioletRed}{t}() gives transpose of a MATRIX or a LIST}\index{t()}
\label{t}
\textcolor{VioletRed}{t}(MATRIX) is the transpose of a MATRIX. As LIST objects can now
be used in matrix computations, \textcolor{VioletRed}{t}(LIST) is also available.
\begin{note}
Multiplying a matrix by the transpose of a matrix can be made by
making new operation '*.
\end{note}
\begin{note}
The argument matrix can also be a submatrix expression.
\end{note}
\subsection{\textcolor{VioletRed}{inverse}()}\index{inverse()}
\label{inverse}
\textcolor{VioletRed}{inverse}(A) computes the inverse of a square MATRIX A. The function utilized dgesv funtion
of netlib. If the argument has type REAL, then the reciprocal is computed,
and the output will also have type REAL. An error occurs, if A is not
a square matrix or REAL, or A is singular according to dgesv.
\begin{note}
instead of writing c=\textcolor{VioletRed}{inverse}(a)*b, it is faster and more accurate to
write c=\textcolor{VioletRed}{solve}(a,b)
\end{note}
\subsection{\textcolor{VioletRed}{solve}() solves a linear equation A*x=b}\index{solve()}
\label{solve}
A linear matrix eqaution A*x=b can be solved for x with code//
x=\textcolor{VioletRed}{solve}(A,b)
\begin{note}
x=\textcolor{VioletRed}{solve}(A,b) is faster and more accurate than x=\textcolor{VioletRed}{inverse}(A)*b
\end{note}
\begin{note}
solve works also if A and b are scalars. This is useful when
working with linear systems which start to grow from scalars.
\end{note}
\subsection{\textcolor{VioletRed}{qr}()}\index{qr()}
\label{qr}
Makes QR decomposition of a MATRIX This can be used to study if columns of a are linearly
dependent. \textbf{J} prints a matrix which indicates the structure of the upper diagonal matrix R in the
qr decomposition. If column k is linearly dependent on previous columns the k’th diagonal
element is zero. If output is given, then it will be the r matrix. Due to rounding errors diagonal
elements which are interpreted to be zero are not exactly zero. Explicit r matrix is useful if user
thinks that \textbf{J} has not properly interpreted which diagonal elements are zero.
In \textbf{J}  \textcolor{VioletRed}{qr}() may be useful when it is studied why a matrix which shoudl
be nonsingular turns out to be singular in \textcolor{VioletRed}{inverse}() or \textcolor{VioletRed}{solve}().
\textcolor{VioletRed}{qr}() is using  the subroutine dgeqrf from Netlib.
An error occurs if the argument is not MATRIX or if dgeqrf produces
error code, which is just printed.
Now the function just shows the linear dependencies, as sho in the examples.
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent Args \tabto{3cm} 1 \tabto{5cm}  MATRIX \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent A m-by-n MATRIX.
\end {changemargin}
\hline
\vspace{0.2cm}
\subsection{\textcolor{VioletRed}{eigen}()}\index{eigen()}
\label{eigen}
Computes eigenvectors and eigenvalues of a square matrix. The eigenvectors are stored as
columns in matrix output\%matrix and the eigenvalues are stored as a row vector
output\%values. The eigenvalues and eigenvectors are sorted from smallest to larges eigenvalue.
Netlib subroutines DLASCL, DORGTR, DSCAL, DSTEQR, DSTERF, DSYTRD,
XERBLA, DLANSY and DLASCL are used.
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent Args \tabto{3cm} 1 \tabto{5cm}  MAT \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent  A square MATRIX.
\end {changemargin}
\hline
\vspace{0.2cm}
\subsection{\textcolor{VioletRed}{sort}() sorts a matrix}\index{sort()}
\label{sort}
Usage://
\textcolor{VioletRed}{sort}(a,\textcolor{blue}{key->}(key1[,key2]))//
Makes a new matrix obtained by sorting all matrix columns of MATRIX a according to one or two columns.
Absolute value of key1 and the value of key2 must be legal column numbers.
If key1 is
positive then the columns are sorted in ascending order,
if key1 is negative then the columns
are sorted in descending order. If two keys are given, then first key dominates.
\begin{note}
It is currently
assumed that if there are two keys then the values in first key column have integer values.
\end{note}
\begin{note}
If key2 is not given and key1 is positive, then the syntax is: \textcolor{VioletRed}{sort}(a,\textcolor{blue}{key->}key1).
\end{note}
\begin{note}
If there is no output, then the argument matrix is sorted in place.lace
\end{note}
\begin{note}
The argument can be the data matrix of a data object. The data object will remain a
valid data object.
\end{note}
\subsection{\textcolor{VioletRed}{envelope}() computes the convex hull of point}\index{envelope()}
\label{envelope}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent Output \tabto{3cm}  1 \tabto{5cm}  MATRIX  \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent  (nvertex+1, 2) matrix of the coordinates of the convex hull, where nvertex is the number of
verteces. The last point is the same as the first point
\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent \textcolor{blue}{arg}  \tabto{3cm} 1 \tabto{5cm}  MATRIX  \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent  (n,2) matrix of point coordinates
\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent \textcolor{blue}{nobs} \tabto{3cm} -1|1 \tabto{5cm}   REAL \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent  gives the number of points if not all
points of the input matrix are used
\end {changemargin}
\hline
\vspace{0.2cm}
\begin{note}
The transpose of the output can be directly used in frawline() function
to draw the envelope
\end{note}
\begin{note}
The function is using a subroutine made by Alan Miller and found in Netlib
\end{note}
\subsection{\textcolor{VioletRed}{find}()}\index{find()}
\label{find}
Function \textcolor{VioletRed}{find}() can be used to find the first matrix element satisfying a given condition, or
all matrix elements satifying the conditon, and in that case the found
elements can be put to a vector containg element numbers or to a
vector which has equal size as the input matrix and where 1 indicates that
the element satifies the condition..
Remember that matrices are stored in row order. If a given column or row should be seaeched,
use submatrix() to extract that row or column.
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent Output \tabto{3cm}  1 \tabto{5cm}   REAL|MATRIX \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent Without \textcolor{blue}{any->} or \textcolor{blue}{expand->} the first element found in row order.
With \textcolor{blue}{any->}, the vector of element numbers satisfying the conditon. If nothing found
the output will be REAL with value zero.
With \textcolor{blue}{expand->}, the matrix of the same dimensions as the input matrix where
hits are marked with 1.
\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent Args \tabto{3cm} 1 \tabto{5cm}  Matrix \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent  The matrix searched.
\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent \textcolor{blue}{filter} \tabto{3cm} 1 \tabto{5cm}  Code \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent Gives the condition which the matrix element should be satisfied. The
values of the matrix elements are put to the variable \$.
\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent \textcolor{blue}{any} \tabto{3cm} -1|0 \tabto{5cm}    \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent  The filtered element numbers are put to the output vector.
\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent \textcolor{blue}{expand} \tabto{3cm} -1|0 \tabto{5cm}   \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent  The filtered elements are put the output matrix
\end {changemargin}
\hline
\vspace{0.2cm}
\begin{example}[findex]Example of find, illustrating also \textcolor{VioletRed}{rann}()\\
\label{findex}
\textcolor{green}{!Repeating\,the\,example,\,different\,results\,will\,be\,obtained}\\
rm=\textcolor{VioletRed}{matrix}(100)\\
m,s=2,3\\
rm=\textcolor{VioletRed}{rann}(m,s)\\
\textcolor{VioletRed}{print}(\textcolor{VioletRed}{mean}(rm),\textcolor{VioletRed}{sd}(rm),\textcolor{VioletRed}{min}(rm),\textcolor{VioletRed}{max}(rm))
\color{Green}
\begin{verbatim}
=   2.4564691829681395
=   3.2549002852383477
=  -5.6481685638427734
=   10.714715003967285
\end{verbatim}
\color{Black}
first=\textcolor{VioletRed}{find}(rm,\textcolor{blue}{filter->}(\$.ge.m+1.96*s))\\
large=\textcolor{VioletRed}{find}(rm,\textcolor{blue}{filter->}(\$.ge.m+1.96*s),\textcolor{blue}{any->})\\
large2=\textcolor{VioletRed}{find}(rm,\textcolor{blue}{filter->}(\$.ge.m+1.96*s),\textcolor{blue}{expand->})\\
\textcolor{VioletRed}{print}(first,100*nrows(large)/\textcolor{VioletRed}{nrows}(rm),100*sum(large2)/\textcolor{VioletRed}{nrows}(rm))
\color{Green}
\begin{verbatim}
first=   12.000000000000000
=   4.0000000000000000
=   4.0000000000000000
\end{verbatim}
\color{Black}
\end{example}
\subsection{\textcolor{VioletRed}{mean}(): means or weighted means of matrix columns}\index{mean()}
\label{mean}
See section matrixstat for details
\subsection{\textcolor{VioletRed}{sum}(): sums or weighted sums of matrix columns}\index{sum()}
\label{sum}
See section matrixstat for details
\subsection{\textcolor{VioletRed}{var}(): Sample variances or weighted variances of matrix c}\index{var()}
\label{var}
See section matrixstat for details
\subsection{\textcolor{VioletRed}{sd}(): sd's or weighted sd's of matrix columns}\index{sd()}
\label{sd}
See section matrixstat for details
\subsection{\textcolor{VioletRed}{minloc}() : locations of the minimum values in columns}\index{minloc()}
\label{minloc}
\textcolor{VioletRed}{minloc}(MATRIX) generates a row vector containing the locations of the  minimum
values in each column. \textcolor{VioletRed}{minloc}(VECTOR) is the REAL scalar telling
the location of the minimum value. Thus the VECTOR can also be a row vector.
\subsection{\textcolor{VioletRed}{maxloc}() : locations of the minimum values in columns}\index{maxloc()}
\label{maxloc}
\textcolor{VioletRed}{maxloc}(MATRIX) generates a row vector containing the locations of the  minimum
values in each column. \textcolor{VioletRed}{maxloc}(VECTOR) is the REAL scalar telling
the location of the maxim value whether VECTOR is a row vector or column vector.
\subsection{\textcolor{VioletRed}{cumsum}(): cumulative sums of matrix columns}\index{cumsum()}
\label{cumsum}
\textcolor{VioletRed}{cumsum}(MATRIX) generates a MATRIX with the same dimesnions as the argument,
and puts the cumulative sums of the columsn into the output matrix.
\begin{note}
If the argument is vector, the cumsum makes a vector having the same
form as the argument.
\end{note}












\subsection{Making correaltion matrix from variance-covariance amtrix: \textcolor{VioletRed}}\index{corrmatrix()}
\label{corrmatrix}
This simple function is sometimes needed. The function does not test wether the input matrix is symmetric.
Negative diagonal eleemnt produces error, value zero correaltion 9,99.
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent Output \tabto{3cm}  1 \tabto{5cm}   MATRIX \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent  matrix having nondiagonal values \textcolor{teal}{Out}(i,j)=\textcolor{teal}{arg}(i,j)=
\textcolor{teal}{arg}(i,j)/\textcolor{VioletRed}{sqrt}(\textcolor{teal}{arg}(i,i)*]arg[(j,j)).
\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent Args  \tabto{3cm} 1 \tabto{5cm}   MATRIX \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent  symmetric matrix
\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent \textcolor{blue}{sd} \tabto{3cm} N|0  \tabto{5cm}    \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent If \textcolor{blue}{sd->} is given, then diagonal elements will be equal to \textcolor{VioletRed}{sqrt}(\textcolor{teal}{arg}(i,i)
\end {changemargin}
\hline
\vspace{0.2cm}
\section{Functions for DATA objects}
\label{dataf}
\textbf{J} contains now the following Functions for DATA objects.
\subsection{\textcolor{VioletRed}{data}()}\index{data()}
\label{data}
Data objects are created with the \textcolor{VioletRed}{data}() function. Two linked data objects can be created with the
same function call (using option \textcolor{blue}{subdata->} and options thereafter in the following
description). It is recommended that two linked data objects are created with one \textcolor{VioletRed}{data}()
function call only in case the data is read from a single file where subdata observations are
stored immediately after the upper data observation.  Data objects can be linked also afterwards with the \textcolor{VioletRed}{linkdata}() function.
A data object can created by a \textcolor{VioletRed}{data}() function when data are read from files
or data are created using transformation objects. New data objects can
be created with \textcolor{VioletRed}{newdata}() function from previous data objects and/or matrices.
If data objects can created using transformation objects either with \textcolor{VioletRed}{data}() function
or by creating first data matrix by transformation and then using \textcolor{VioletRed}{newdata}() to
create data object.
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent Output  \tabto{3cm} 0|1 \tabto{5cm}  Data \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent \noindent Output  \tabto{3cm} 0|1 \tabto{5cm}  Data \tabto{7cm}
Data object to be created. If there is no output then the default is \$Data\$.
It is recommended that this default is used only when only one data object
is used in the analysis.
!
\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent \textcolor{blue}{read}  \tabto{3cm} 0|1- \tabto{5cm}  REAL|List \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent  Variables read from the input files or the name of the list containing all variables
to be read in. If no arguments are given and there is no readfirst-> option
then the variables to read in are stored in the first line of the data file separated
with commas.?? Also the … -shortcut can be used to define the varaible list. If no arguments are given and
there is readfirst-> option then the variable names are read from the second
line.
\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent \textcolor{blue}{in}  \tabto{3cm} 0- \tabto{5cm}  Char \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent input file or list of input files. If no files are given, data is read from the following input
paragraph. If either of \textcolor{blue}{read->} or \textcolor{blue}{in->} option is given, then both options must
be present.
\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent \textcolor{blue}{form}  \tabto{3cm} -1|1 \tabto{5cm}  Char \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent  Format of the data as follows \newline
\$  Fortran format '*', the default \newline
b    Single precison binary \newline
bs  Single precison binary opened with access='stream'
Needed for Pascal files in Windows. \newline
B  Double precison binary.\newline
Char giving a Fortran format, e.g. '(4f4.1,1x,f4.3)' \newline
d4 Single precison direct access for Gfortran files.\newline
d1 Single precison direct acces for Intel Fortran files.
\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent \textcolor{blue}{maketrans} \tabto{3cm} -1|1 \tabto{5cm}  TRANS  \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent Transformations computed for each observation when reading the data


\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent \textcolor{blue}{keep} \tabto{3cm} -1|1- \tabto{5cm}  REAL \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent  variables kept in the data object, default: all \textcolor{blue}{read->} variables plus the output
variables of \textcolor{blue}{maketrans->} transformations.

\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent \textcolor{blue}{obs} \tabto{3cm} -1|1 \tabto{5cm}  REAL \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent  Variable which gets automatically the observation number when working with the
data, variable is not stored in the data matrix, default: Obs. When working with
hierarchical data it is reasonable to give obs variable for each data object.

\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent \textcolor{blue}{filter} \tabto{3cm} -1|1 \tabto{5cm}  Code \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent  logical or arithmetic statement (nonzero value indicating True) describing which
observations will be accepted to the data object. \textcolor{blue}{maketrans->}-transformations are
computed before using filter. Option \textcolor{blue}{filter->} can utilize automatically created
variable Record which tells which input record has been just read. If observations
are rejected, then the Obs-variable has as its value number of already accepted
observations+1.

\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent \textcolor{blue}{reject}  \tabto{3cm} -1|1 \tabto{5cm}  Code \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent  Logical or arithmetic statement (nonzero value indicating True) describing which
observations will be rejected from the data object. If \textcolor{blue}{filter->} option is given then
reject statement is checked for observations which have passed the filter. Option
\textcolor{blue}{reject->} can utilize automatically created variable Record which tells which
input record has been just read. If observations are rejected, then the Obsvariable has as its value number of already accepted observations+1.
subdata the name of the lower level data object to be created. This option is not allowed, if
there are multiple input files defined in option \textcolor{blue}{in->}.

subread,…,subobs sub data options similar as \textcolor{blue}{read->}…obs-> for the upper level data.
(\textcolor{blue}{subform->}'bgaya' is the format for the Gaya system). The following options
can be used only if \textcolor{blue}{subdata->} is present

\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent \textcolor{blue}{nobsw}  \tabto{3cm}  -1|1  \tabto{5cm}  REAL \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent  A variable in the upper data telling how many subdata observations there is under
each upper level observation, necessary if \textcolor{blue}{subdata->} option is present.

\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent \textcolor{blue}{nobswcum} \tabto{3cm} -1|1 \tabto{5cm}  REAL \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent  A variable telling the cumulative number of subdata observations up to the
current upper data observation but not including it. This is useful when accessing
the data matrix one upper level unit by time, i.e., the observation numbers within
upper level observation are nobswcum+1,…,nobswcum+nobsw

\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent \textcolor{blue}{obsw} \tabto{3cm} -1|1 \tabto{5cm}   REAL  \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent  A variable in the subdata which automatically will get the number of observation
within the current upper level observation, i.e. obsw variable gets values from 1
to the value of nobsw-variable, default is 'obs\_variable\%obsw'.

\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent \textcolor{blue}{duplicate} \tabto{3cm} -1|2 \tabto{5cm}   TRANS  \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent \noindent duplicate \tabto{3cm} -1|2 \tabto{5cm}   TRANS  \tabto{7cm}
The two transformation object arguments describe how observations in the subdata
will be duplicated. The first transformation object should have Duplicates as an
output variable so that the value of Duplicates tells how many duplicates ar
made (0= no duplication). The second transformation object defines how the values
of subdata variables are determined for each duplicate. The number of duplicate
is transmitted to the variable Duplicate. These transformations are called also
when Duplicate=0. This means that when there is the \textcolor{blue}{duplicate->} option,
then all transformations for the subdata can be defined in the duplicate
transformation object, and \textcolor{blue}{submaketrans->} is not necessary.

\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent \textcolor{blue}{oldsubobs} \tabto{3cm} -1|1 \tabto{5cm}   REAL \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent  If there are duplications of sub-observations, then this option gives the variable
into which the original observation number is put. This can be stored in the
subdata by putting it into \textcolor{blue}{subkeep->} list, or, if \textcolor{blue}{subkeep->} option is not given
then this variable is automatically put into the \textcolor{blue}{keep->} list of the subdata.

\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent \textcolor{blue}{oldobsw} \tabto{3cm} -1|1 \tabto{5cm}  REAL \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent  This works similarly with respect to the initial obsw variable as \textcolor{blue}{oldsubobs->}
works for initial obs variable.

\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent \textcolor{blue}{nobs} \tabto{3cm} -1|1 \tabto{5cm}  Real \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent  There are two uses of this option. First, a data object can be created without reading
from a file or from the following input paragraph by using \textcolor{blue}{nobs->} option and
\textcolor{blue}{maketrans->} transformation, which can use Obs variable as argument. Creation
of data object this way is indicated by the presence of \textcolor{blue}{nobs->} option and absence
of \textcolor{blue}{in->} and \textcolor{blue}{read->} options. Second, if \textcolor{blue}{read->} option is present \textcolor{blue}{nobs->}
option can be used to indicate how many records are read from a file and what
will be the number of observations. Currently \textcolor{blue}{reject->} or \textcolor{blue}{filter->} can not
be used to reject records (consult authors if this would be needed). If there are
fewer records in file as given in \textcolor{blue}{nobs->} option, an error occurs. There are three
reasons for using \textcolor{blue}{nobs->} option this way. First, one can read a small sample
from a large file for testing purposes. Second, the reading is slightly faster as the
data can be read directly into proper memory area without using linked buffers.
Third, if the data file is so large that a virtual memory overflow occurs, then it may
be possible to read data in as linked buffers are not needed.
In case \textcolor{blue}{nobs->} option is present and \textcolor{blue}{read->} option is absent either
\textcolor{blue}{maketrans->} or \textcolor{blue}{keep->} option (or both) is required.
\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent \textcolor{blue}{buffersize} \tabto{3cm} -1|1 \tabto{5cm}  Real \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent \noindent buffersize \tabto{3cm} -1|1 \tabto{5cm}  Real \tabto{7cm}
The number of observations put into one temporary working buffer. The default
is 10000. Experimentation with different values of \textcolor{blue}{buffersize->} in huge data
objects may result in more efficient \textcolor{blue}{buffersize->} than is the default (or perhaps
not). Note that the buffers are not needed if number of observations is given in
\textcolor{blue}{nobs->}.

\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent \textcolor{blue}{par} \tabto{3cm} -1|1- \tabto{5cm}   Real \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent additional parameters for reading. If \textcolor{blue}{subform->} option is 'bgaya' then par
option can be given in form \textcolor{blue}{par->}(ngvar,npvar) where ngvar is the number
of nonperiodic x-variables and npvar is the number of period specific x-variables
for each period. Default values are \textcolor{blue}{par->}(8,93).

\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent \textcolor{blue}{rfhead}  \tabto{3cm} -1|0 \tabto{5cm}    \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent  When reading data from a text file, the first line can contain a header which is
printed but othewise ignored

\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent \textcolor{blue}{rfcode}  \tabto{3cm} -1|0 \tabto{5cm}    \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent The data file can contain also J-code which is first executed. Note the code can
be like var1,var,x1...x5=1,2,3,4,5,6,7, which give the possibility to
define variables which describe the \textcolor{blue}{in->} file.


rfsubhead-> works for subdata similarly as \textcolor{blue}{rfhead->} for data.
rfsubcode works for subdata similarly as \textcolor{blue}{rfcode->} for data

If there are both \textcolor{blue}{rfhead->} and \textcolor{blue}{rfcode->} then \textcolor{blue}{rfhead->} is excuted first.
\textcolor{blue}{rfhead->} and \textcolor{blue}{rfcode->} replace readfirst-> option  of previous versions which was too
complicated.
\end {changemargin}
\hline
\vspace{0.2cm}

\begin{note}
\textcolor{VioletRed}{data}() function will create a data object object, which is a compound object consisting
of links to data matrix, etc. see Data object object. If Data is the output
of the function, the function creates the list Data\%keep telling the
variables in the data and
Data\%matrix containg the data as a single precision matrix. The number of observations can be obtained by \textcolor{VioletRed}{nobs}(Data) or by
\textcolor{VioletRed}{nrows}(Data\%matrix).
\end{note}
\begin{note}
See common options section for how data objects used in other \textbf{J} functions will be defined.
\end{note}
\begin{note}
The \textcolor{blue}{in->} and \textcolor{blue}{subin->} can refer to the same file, or if both are without arguments
then data are in the following input paragraph. In this case \textcolor{VioletRed}{data}() function read first one
upper level record and then \textcolor{blue}{nobsw->} lower level records.
\end{note}
\begin{note}
When reading the data the \textcolor{blue}{obs->}variable (default Obs) can be used in maketrans-
> transformation and in \textcolor{blue}{reject->} option and \textcolor{blue}{filter->} option, and the variable refers to
the number of observation in resulting data object. The variable Record gets the number of
the read record in the input file, and can be used in \textcolor{blue}{maketrans->} transformations and in
\textcolor{blue}{reject->} and \textcolor{blue}{filter->} options. If \textcolor{blue}{subdata->} option is given, variable Subreject gets
the number of record in the sub file, and it can be used in \textcolor{blue}{submaketrans->} transformations
and in \textcolor{blue}{subreject->} option and in \textcolor{blue}{subfilter->} option.
\end{note}
\begin{note}
Options \textcolor{blue}{nobs->}100, \textcolor{blue}{reject->}(Record.gt.100) and \textcolor{blue}{filter->}
(Record.le.100) result in the same data object, but when reading a large file, the \textcolor{blue}{nobs->}
option is faster as the whole input file is not read.
\end{note}
\begin{note}
If no observations are rejected, obs variable and Record variable get the same values.
\end{note}
\begin{note}
If virtual memory overflow occurs, see \textcolor{blue}{nobs->} optio. This should not happen easily with the currrent
64-bit application.
\end{note}
\begin{note}
Earlier versions contained \textcolor{blue}{trans->} and \textcolor{blue}{subtrans->}options which associated
a permanent transformation object with the data object. This feature is now deleted because
it may confuse and is not really needed. If tranformations are needed in functions
they can always be included using \textcolor{blue}{trans->} .
\end{note}
\begin{example}[dataex]data() generates a new data object by reading data.\\
\label{dataex}
data1=\textcolor{VioletRed}{data}(\textcolor{blue}{read->}(x1...x3),\textcolor{blue}{in->})\\
1,2,3\\
4,5,6\\
7,8,9\\
/
\end{example}
\subsection{\textcolor{VioletRed}{newdata}()}\index{newdata()}
\label{newdata}
Function \textcolor{VioletRed}{newdata}() generates a new data object from existing data objects and/or
matrices possibly using transformations to generate new variables.
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent Output \tabto{3cm} 1 \tabto{5cm}  Data \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent The data object generated.
\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent Args \tabto{3cm} 1- \tabto{5cm}  Data|Matrix \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent  Input matrices and data objects.
\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent \textcolor{blue}{read} \tabto{3cm} N|1- \tabto{5cm}  REAL \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent  Variable names for columns of matrices in the order of
matrices.
\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent \textcolor{blue}{maketrans} \tabto{3cm} N|1 \tabto{5cm}   TRANS  \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent  A predefined ransformation object computed for each observation.
\end {changemargin}
\hline
\vspace{0.2cm}
\begin{note}
It is not yet possible to drop variables.
\end{note}
\begin{note}
An error occurs if the same variable is several times in the variable list obtained
by combining variables in data sets and \textcolor{blue}{read->} variables.
\end{note}
\begin{note}
An error occurs if the numbers of rows of matrices and observations in data sets
are not compatible.
\end{note}
\begin{note}
Output variables in \textcolor{blue}{maketrans->} transformations whose name start with \$ are not put into the new data object.
\end{note}
\begin{example}[newdataex]newdata() generates a new data object.\\
\label{newdataex}
data1=\textcolor{VioletRed}{data}(\textcolor{blue}{read->}(x1...x3),\textcolor{blue}{in->})\\
1,2,3\\
4,5,6\\
7,8,9\\
/\\
matrix1=\textcolor{VioletRed}{matrix}(3,2,\textcolor{blue}{in->})\\
10,20\\
30,40\\
50,60\\
/\\
newtr=\textcolor{VioletRed}{trans}()\\
\textcolor{Red}{;do}(i,1,3)\\
\textcolor{Red}{;do}(j,1,2)\\
x"i"\#z"j"=x"i"*z"j"\\
\textcolor{Red}{;enddo}\\
\textcolor{Red}{;enddo}\\
/\\
new=\textcolor{VioletRed}{newdata}(data1,matrix1,\textcolor{blue}{read->}(z1,z2),\textcolor{blue}{maketrans->}newtr)\\
\textcolor{VioletRed}{print}(new)
\end{example}
\subsection{\textcolor{VioletRed}{exceldata}()}\index{exceldata()}
\label{exceldata}
Generates data object from csv data generated with excel. It is assumed that ';' is used as column separator,
and first is the header line generated with excel and containing column names.
The second line contains information for \textbf{J} how to read the data.
First the first line is copied and pasted as the second line. To the beginning of the second line is put
'@\#'. Then each entry separated by ';' is edited as follows. If the column is just ignored, then
put '!' to the beginning of the entry. If all characters in the column are read in as
a numeric variable, change the name to accpetable variable name in J.
If the column is read in but it is just used as an input variable fot
\textcolor{blue}{maketrans->} trasformations, then start the name with '\$' so the variable is not put to
the list of \textcolor{blue}{keep->} variables. If a contains only character values then it must
be ignored using '!'. If the contains numeric values surrounded by characters, the the numeric value can be picked
as follows. Put '?' to the end of entry. Put the variable name to the beginning of the entry.
then put the the number of characters to be ignored by two digits, inserting
aleading zero if needed. The given the length of the numeric field to be read in as a numeric value.
For instance, if the header line in the excel file is
\color{Green}
\begin{verbatim}
Block;Contract;Starting time;Name of municipality;Number of stem;Species code
\end{verbatim}
\color{Black}
and the first data line could be
\color{Green}
\begin{verbatim}
MG_H100097362501;20111001;7.5.2021 9:37;Akaa;20;103;1;FI2_Spruce
\end{verbatim}
\color{Black}
then the second line before the first data line could be
\color{Green}
\begin{verbatim}
##block0808?;!Contract;!Starting time;!Name of municipality;stem;species0201?
\end{verbatim}
\color{Black}
therafter the first observation would get values block=97362501,stem=1, and
species=2.

If there are several input files, the header line of later input lines is ignored, and
also if the second line of later files starts with '\#\#', then it is ignored.
if any later lines in any input files start with 'jcode:', then the code is computed.
This way variables decribing the whole input file can be transmitted to the data.
Currently jcode-output variables can be transmitted to data matrix only by using the as pseudo
outputvariables in maketrans-transformations, e.g., filevar1=filevar1, if
filevar1 is generated in jcode transformation.
If there are several input files the file number is put into variable In before computing maketrans transformations
and this variable is automatically stored in the data matrix.
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent Output \tabto{3cm} 1 \tabto{5cm}  Data \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent  Data object generated
\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent \textcolor{blue}{in} \tabto{3cm} 1- \tabto{5cm}  Char \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent Files to read in.
\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent \textcolor{blue}{maketrans} \tabto{3cm} N|1 \tabto{5cm}  trans \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent  Transformations used to compute new variables to be stored
in the data.
\end {changemargin}
\hline
\vspace{0.2cm}
\subsection{\textcolor{VioletRed}{linkdata}() links hierarchical data sets}\index{linkdata()}
\label{linkdata}
\textcolor{VioletRed}{linkdata}(\textcolor{blue}{data->},\textcolor{blue}{subdata->},\textcolor{blue}{nobsw->}[,\textcolor{blue}{obsw->}])//
links hierarchical data sets.
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent \textcolor{blue}{data} \tabto{3cm} 1 \tabto{5cm}  DATA \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent  the upper level data set object
\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent \textcolor{blue}{subdata}  \tabto{3cm} 1 \tabto{5cm}  DATA \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent  the lower data set object
\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent \textcolor{blue}{nobsw} \tabto{3cm} 1 \tabto{5cm}  REAL  \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent  the name of variable telling the number of lower level observations for each
\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent \textcolor{blue}{obsw}  \tabto{3cm}  0|1  \tabto{5cm}  REALV  \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent variable which will automatically get the number of lower level observation within
each upper level observation. If not given, then this variable will be
the Obs-variable of the upper level data.
\end {changemargin}
\hline
\vspace{0.2cm}
\begin{note}
In most cases links between data sets can be either made using sub-options of \textcolor{VioletRed}{data}()
function or \textcolor{VioletRed}{linkdata}() function. If there is need to duplicate lower level observations, then
this can be currently made only in \textcolor{VioletRed}{data}() function. Also when the data for both the upper
level and lower level data are read from the same file, then \textcolor{VioletRed}{data}() function must be used.
\end{note}
\begin{note}
When using linked data in other functions, the values of the upper level variables are
automatically obtained when accessing lower level observations. Which is the observational
unit in each function is determined which data set is given in \textcolor{blue}{data->} option or defined using
Data list.
\end{note}
\begin{note}
In the current version of \textbf{J} it is no more necassary to use linked data sets in
\textcolor{VioletRed}{jlp}() function, as the treatment unit index in data containing both
stand and schdedule data can be given in unit-> option
\end{note}
\subsection{\textcolor{VioletRed}{getobs}() loads an obsevarion from  DATA}\index{getobs()}
\label{getobs}
Getting an observation from a data set: //
\textcolor{VioletRed}{getobs}(dataset,obs[,\textcolor{blue}{trans->}])//
Get the values of all variables associated with observation obs in data object dataset. First all the
variables stored in row obs in the data matrix are put into the corresponding real variables. If
a transformation set is permanently associated with the data object, these transformations are
executed.
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent dataset \tabto{3cm} 1 \tabto{5cm}  DATA  \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent  the DATA object
\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent \textcolor{blue}{obs}  \tabto{3cm} 1 \tabto{5cm}   REAL \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent  row number in the data matrix of the dataset
\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent \textcolor{blue}{trans} \tabto{3cm} -1|1  \tabto{5cm}   TRANS  \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent  these transformations are also executed.
\end {changemargin}
\hline
\vspace{0.2cm}
\subsection{\textcolor{VioletRed}{nobs}(): number of observations in DATA or REGR}\index{nobs()}
\label{nobs}
\textcolor{VioletRed}{nobs}(DATA) returns the number of rows in the data matrix of DATA//
\textcolor{VioletRed}{nobs}(REGR) returns the number of observations used to compute
the regression with \textcolor{VioletRed}{regr}().
\subsection{\textcolor{VioletRed}{classvector}()}\index{classvector()}
\label{classvector}
Function classvector computes vectors from data which extract information from grouped
data. These vectors can be used to generate new data object using \textcolor{VioletRed}{newdata}() function or
new matrices from submatrices using \textcolor{VioletRed}{matrix}() function with \textcolor{blue}{matrix->} option or
they can be used in transformation objects to compute class related things.
There is no explicit output for the function, but several output vectors can
be generated depending on the arguments and \textcolor{blue}{first->}, \textcolor{blue}{last->} and
\textcolor{blue}{expand->} options. The function prints the names of the output vectors generated.
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent Args \tabto{3cm} 0- \tabto{5cm}  REAL \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent  The variables whose class information is computed. Arguments
are not necessary if \textcolor{blue}{first->} and/or \textcolor{blue}{last->} are present.
Let §Arg be the generic name for arguments.
\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent \textcolor{blue}{class} \tabto{3cm} 1 \tabto{5cm}  REAL \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent  .oindent class \tabto{3cm} 1 \tabto{5cm}  REAL \tabto{7cm}
\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent \textcolor{blue}{class} \tabto{3cm} 1 \tabto{5cm}  REAL \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent The variable indicating the class. The class variable which must be present in the data object or which is
an output variable of the \textcolor{blue}{trans->} transformations.
When the \textcolor{blue}{class->} variable, denoted as
as §Class changes,
the class changes.
\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent \textcolor{blue}{data} \tabto{3cm} 0|1 \tabto{5cm}  Data \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent Data object used. Only one data object used; extra \textcolor{blue}{data->} objects just ignored. The default is the last
data object generated.
\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent \textcolor{blue}{expand} \tabto{3cm} -1|0 \tabto{5cm}    \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent If \textcolor{blue}{expand->} is present then the lengths output vectors are equal
to the number of observations in the data object and the values of the class variables
are repeated as many times as there are observations in each class. If
\textcolor{blue}{expand->} is not present, the lengths of the output vectors are.
equal to the number of classes.
\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent \textcolor{blue}{first} \tabto{3cm} 0 \tabto{5cm}    \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent The the number of first observation in class is stored in vector
§Class\%\%first if \textcolor{blue}{expand->} is present and §Class\%first if \textcolor{blue}{expand->} is not present.
\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent \textcolor{blue}{last} \tabto{3cm} 0 \tabto{5cm}    \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent The the number of lastt observation in class is stored in vector
§Class\%\%last if \textcolor{blue}{expand->} is present and §Class\%last if \textcolor{blue}{expand->} is not present.
\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent \textcolor{blue}{obsw} \tabto{3cm} 0 \tabto{5cm}    \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent If there axpnad-> option then vector Class\%\%obsw
\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent \textcolor{blue}{ext} \tabto{3cm} -1|1 \tabto{5cm}  Char \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent The extension to the names of vectors generated for arguments. Let
Ext be denote the extension.
\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent \textcolor{blue}{mean} \tabto{3cm} -1|0 \tabto{5cm}    \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent The class means are stored in the vectors \newline
§Arg\#Class\%\%mean with \textcolor{blue}{expand->} and without \textcolor{blue}{ext->}\newline
§Arg\#Class\%\%meanExt with \textcolor{blue}{expand->} and with \textcolor{blue}{ext->} are \newline
§Arg\#Class\%mean without \textcolor{blue}{expand->} and without \textcolor{blue}{ext->} \newline
§Arg\#Class\%meanExt without \textcolor{blue}{expand->} and with \textcolor{blue}{ext->}
\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent \textcolor{blue}{sd} \tabto{3cm} -1|0 \tabto{5cm}    \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent  Class standard deviations are computed to sd vectors
\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent \textcolor{blue}{var} \tabto{3cm} -1|0 \tabto{5cm}    \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent  Class variances are computed to var vectors
\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent \textcolor{blue}{min} \tabto{3cm} -1|0 \tabto{5cm}    \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent  Class minimums are computed to min vectors
\end{changemargin}
\vspace{0.3cm}
\hline
\vspace{0.3cm}
\noindent \textcolor{blue}{max} \tabto{3cm} -1|0 \tabto{5cm}    \tabto{7cm}
\begin{changemargin}{3cm}{0cm}
\noindent  Class maximums are computed to max vectors.
\end {changemargin}
\hline
\vspace{0.2cm}
\begin{note}
Numbers of observations in each class can be obtained by \\
Class\%nobs=Class\%\%last-Class\%\%first+1 when \textcolor{blue}{expand->} is present, and \\
Class\%nobs=Class\%\%last-Class\%\%first+1
\end{note}
\begin{example}[newclassdata]Making class level data object\\
\label{newclassdata}
\textcolor{VioletRed}{classvector}(x1,x2,\textcolor{blue}{class->}stand,\textcolor{blue}{data->}treedata,\textcolor{blue}{mean->},\textcolor{blue}{min->})\\
standdata=\textcolor{VioletRed}{newdata}(x1\#stand\%mean,x2\#stand\%mean,x1\#stand\%min,x2\#stand\%min,\\
\textcolor{blue}{read->}(x1,x2,x1min,x2min))
\end{example}
\begin{example}[addingclass]Adding class means and deviations from class means\\
\label{addingclass}
\textcolor{VioletRed}{classvector}(x1,x2,\textcolor{blue}{class->}stand,\textcolor{blue}{data->}treedata,\textcolor{blue}{mean->},\textcolor{blue}{expand->})\\
tr=\textcolor{VioletRed}{trans}()\\
relx1=x1-x1mean\\
relx2=x2-x2mean\\
/\\
treedata=\textcolor{VioletRed}{newdata}(treedata,x1\#stand\%mean,x2\#stand\%mean,\textcolor{blue}{read->}(x1mean,x2mean),\\
\textcolor{blue}{maketrans->}tr)
\end{example}

